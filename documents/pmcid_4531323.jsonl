{"display_title": "PMID: 26321901 batch: 7", "list_title": "batch 7 PMID26321901 3D interactive tractography-informed resting-state fMRI connectivity ", "metadata": {"batch_nb": 7, "journal": "Frontiers in neuroscience", "origin_file": "documents_season_1.jsonl", "pmcid": 4531323, "pmid": 26321901, "publication_year": 2015, "text_md5": "c6b8b84a3d7637808031beeb7df56666", "title": "3D interactive tractography-informed resting-state fMRI connectivity."}, "text": "PMID26321901        TITLE         3D interactive tractography-informed resting-state fMRI connectivity        ABSTRACT           In the past decade, the fusion between diffusion magnetic resonance imaging (dMRI) and functional magnetic resonance imaging (fMRI) has opened the way for exploring structure-function relationshipsin vivo. As it stands, the common approach usually consists of analysing fMRI and dMRI datasets separately or using one to inform the other, such as using fMRI activation sites to reconstruct dMRI streamlines that interconnect them. Moreover, given the large inter-individual variability of the healthy human brain, it is possible that valuable information is lost when a fixed set of dMRI/fMRI analysis parameters such as threshold values are assumed constant across subjects. By allowing one to modify such parameters while viewing the results in real-time, one can begin to fully explore the sensitivity of structure-function relations and how they differ across brain areas and individuals. This is especially important when interpreting how structure-function relationships are altered in patients with neurological disorders, such as the presence of a tumor. In this study, we present and validate a novel approach to achieve this: First, we present an interactive method to generate and visualize tractography-driven resting-state functional connectivity, which reduces the bias introduced by seed size, shape and position. Next, we demonstrate that structural and functional reconstruction parameters explain a significant portion of intra- and inter-subject variability. Finally, we demonstrate how our proposed approach can be used in a neurosurgical planning context. We believe this approach will promote the exploration of structure-function relationships in a subject-specific aspect and will open new opportunities for connectomics.           BODY            1. Introduction    In the era of multi-modal magnetic resonance imaging (MRI), combining diffusion MRI (dMRI), and functional MRI (fMRI) permits a unique way of exploring structure-function relationships   in vivo   . With dMRI (Le Bihan and Breton,  ; Le Bihan et al.,  ; Basser and Jones,  ), it is possible to probe the microstructure of biological tissues such as white matter connections of the brain (i.e., structural connectivity). On the other hand, fMRI provides 4D whole-brain images that reflect changes in cortical blood flow, volume and oxygen as measured by the Blood-Oxygenation-Level-Dependant (BOLD) signal (Turner,  ; Kwong et al.,  ; Bandettini et al.,  ). At rest, the spontaneous low frequency fluctuations (< 0.08\u20130.1 Hz) in the BOLD signal allow the detection of temporally correlated spatial patterns, also known as Resting State Networks (RSNs) (Biswal et al.,  ; Damoiseaux et al.,  ). The common way of exploring such RSNs is to extract the preprocessed BOLD time course from an a priori region of interest (ROI) and compute the temporal correlation with all other voxels of the brain. The result is a   seed-specific   correlation map or a functional connectivity map.    Integrating dMRI and fMRI is often necessary to understand how patterns of functional connectivity are related to structural connectivity. For instance, is functional connectivity present in the absence of structural connectivity, or is one predictive of the other (Honey et al.,  )? While many studies have investigated this in the past (Honey et al.,  ; van den Heuvel et al.,  ; Mennes et al.,  ; Zhang et al.,  ; V\u00e1rkuti et al.,  ; Bowman et al.,  ; Hermundstad et al.,  ; Sporns,  ; Whittingstall et al.,  ; Goni et al.,  ; Ward et al.,  ; Zhu et al.,  ), surprisingly few studies have investigated how subtle changes in the analysis pipeline may alter structure-function relationships (Bastiani et al.,  ). For example, functional connectivity between highly vascularized areas may be artificially large due to increased signal-to-noise-ratio (SNR) (Vigneau-Roy et al.,  ). Many parameters, such as the correlation threshold and cluster size, can influence functional connectivity matrices (Gorgolewski et al.,  ; Stevens et al.,  ; Woo et al.,  ). On the other hand, structural connectivity based on streamline tractography is known to be biased by the many stopping criteria involved in such reconstructions (i.e., step size, tracking mask, angular deviation, seeding strategy, etc.) (Girard et al.,  ) or algorithms (Bastiani et al.,  ). A slight change in these traditional thresholds might perturb the connectivity profile of certain brain areas. As such, different regions of the brain may benefit from different reconstruction parameters (Chamberland et al.,  ).    Additionally, it can be difficult to select the appropriate rs-fMRI seed points in subjects with pathological developments such as cerebral tumors, lesions, and other abnormalities (Griffa et al.,  ; Chamberland et al.,  ), where white matter bundles and associated cortex are often displaced. In a clinical setting, it would be advantageous if neurosurgeons could instantly view how a slight change in reconstruction parameters impacts the results. Clearly, addressing this issue is difficult, as it would require computing structural and functional connectivity using many sets of pre-defined parameters and then find ways to interact and interpret the connectivity profiles. Therefore, the possibility of visualizing and quantifying structural and functional connectivity while simultaneously modifying important reconstruction parameters could change the way structure-function relationships are studied in single subjects and could lead to an optimized and more efficient way of analysing data in large cohorts of healthy and/or patient populations. Moreover, efficient scientific visualization is important when analysing and illustrating multi-modal MRI data (Irimia et al.,  ; Margulies et al.,  ; Rojas et al.,  ). With emerging human connectome studies and the growing interest of applying rs-fMRI in surgical planning and other clinical applications (Daducci et al.,  ; Griffa et al.,  ; Meskaldji et al.,  ), interactively exploring the circuitry of the brain is essential.    Overall, traditional ways of coupling dMRI with fMRI often come down to reconstructing fiber pathways between distant fMRI regions. However, not much attention has been given in the development of new methods where dMRI assists fMRI. To the best of our knowledge, no previous literature shows how tractography could serve as a guide to generate rs-fMRI connectivity. In this work, we propose an interactive method for the exploration of single-subject brain connectivity in a fully 3D interactive fashion, which can be coupled with our existing real-time fiber tractography method robust to crossings implemented in a freely available software, i.e., the   Fibernavigator   (Chamberland et al.,  ). Using a new reconstruction technique, namely   tractography-driven resting-state   , we demonstrate how structural and functional connectivity can be merged together to explore the brain in a mutual and interactive manner. The contributions of this work are thus three-fold:       We present an interactive method to explore and visualize tractography-driven resting-state functional connectivity.      We demonstrate that structural and functional reconstruction parameters may explain a portion of intra- and inter-subject variability.      We qualitatively demonstrate how the proposed methods can be used in a neurosurgical planning context.         2. Methods    This section is organized as follow: First, we describe the MRI acquisition protocols as well as the data processing. Next, we present the technical implementation and characteristics of the proposed method. Finally, the last part of this section includes the full description of the experiments performed to evaluate the proposed method.     2.1. MRI acquisition    Datasets were obtained from 10 young healthy volunteers (ages 21\u201330, 4 females). In addition, 1 dataset was acquired from a tumor patient (31 year old, male) with astrocytoma of grade III located near the motor cortex. Imaging was performed on a 1.5 T SIEMENS Magnetom (Vision). Subject motion was minimized using head cushions. MRI sessions started with a T1-weighted 1 mm isotropic MPRAGE (TR/TE 1860/3.54 ms) image. Continuous functional recordings were carried out using a standard echo-planar imaging (EPI) sequence (eyes closed). For each run, 108 functional volumes consisting of 35 axial slices were obtained with a 64 \u00d7 64 matrix, field of view (FOV) 220 mm, TR/TE 2730/40 ms, for a voxel size of 3.4 \u00d7 3.4 \u00d7 4.2 mm3. Additionally, high angular resolution diffusion imaging (HARDI) data was acquired using a single-shot EPI spin echo sequence (TR/TE = 11700/98 ms), with   b   -value of 1000 s/mm2and 64 uniform directions (matrix size: 128 \u00d7 128, 2 mm isotropic spatial resolution). To reduce susceptibility distortions, GRAPPA parallel imaging was employed with an acceleration factor of 2. The study was performed according to the guidelines of the Internal Review Board of the Centre Hospitalier Universitaire de Sherbrooke (Comit\u00e9 d'\u00e9thique de la recherche sur I'humain du CHUS).      2.2. Data processing     2.2.1. T1 processing    Non-local means (NLM) denoising was applied to the T1-weigthed image prior to using the brain extraction tool (BET) of FSL (Smith,  ). This facilitated the registration procedure to the upsampled (1 mm isotropic resolution)   b   = 0 diffusion image using ANTS (Avants et al.,  ).      2.2.2. dMRI processing    NLM denoising was performed on the raw diffusion data (Descoteaux et al.,  ). Diffusion tensors, RGB map and corresponding fractional anisotropy (FA) were estimated using MRtrix (Tournier et al.,  ). The single fiber response function was estimated (FA > 0.7). This response function was used as input to spherical deconvolution (Tournier et al.,  ; Descoteaux et al.,  ) to compute the fiber orientation distribution function (fODF) at each voxel of the brain. In this work, we used the efficient implementation publicly available in MRtrix (Tournier et al.,  ) with a maximal spherical harmonics order of 8 and the default parameters. All dMRI derived metrics were upsampled to a 1 mm isotropic resolution using trilinear interpolation (Dyrby et al.,  ; Girard et al.,  ; Smith et al.,  ; Tournier et al.,  ). Finally, the spherical harmonics peaks (i.e., main directions of diffusion, 3 per voxel) of each fODF were then extracted and served as input for real-time fiber tractography (Chamberland et al.,  ).      2.2.3. fMRI processing    Images were first motion and slice-time corrected using the efficient implementation publicly available in AFNI (Cox,  ). Next, the data were spatially smoothed using NLM denoising (Coupe et al.,  ; Bernier et al.,  ) implemented in Dipy (Garyfallidis et al.,  ) using default parameters, and band-pass filtered (0.008\u20130.08 Hz). The global signal at each voxel was not regressed to avoid the introduction of anti-correlated regions (Saad et al.,  ).       2.3. Resting-state connectivity and visualization    Our interactive rs-fMRI exploration method is implemented on CPU and runs on a single core computer, which does not require any specific hardware. It works on any fMRI data (e.g., resting-state) which is preferably pre-processed (i.e., motion and slice time corrected, spatial and temporal filtered). For anatomical reference, the user has to provide a subject-specific underlying anatomical image (e.g., T1, T2, FA, b0, etc.). By placing a cubical or spherical ROI within the 3D environment (high resolution anatomical space), one can instantaneously activate the functional correlation module while dragging the seed-ROI anywhere in the brain. The mean BOLD signal is first extracted from the voxels encompassed by the ROI, and then statistically compared to the rest of the brain. The correlation coefficient (   r   ) between voxels x and y is denoted as:   r   = cov(x, y)/\u03c3   x   \u03c3   y   , where cov(x, y) is the covariance of the preprocessed BOLD signals and \u03c3   x   \u03c3   y   are the standard deviations. The generated correlation coefficients are then converted to   z   -scores (Whittingstall et al.,  ) and rendered at each voxel as small particles (   z   > 0), which are depth-sorted in real-time according to the user's viewing axis.    To reduce cluttering, the opacity (alpha) and size of each particle are weighted by their associated   z   -score value as seen in Figure  . This way, regions showing higher correlations are displayed predominantly over less correlated ones. Interactive correlation (   z   -score) and cluster-size (\u03b7   min   ) thresholds are also available for visualization purposes. A flood fill algorithm is responsible for determining the minimum number of connected voxels (faces touching) to form and display fMRI-clusters (with respect to \u03b7   min   ). In a last step, the user can save and export the generated activation map into a 3D nifti file. Note that the computation step is performed in native space (i.e., fMRI space) while the rendering stage is done at the anatomical level (e.g., T1-space) using the scaling transformation matrix associated to the anatomical and rs-fMRI datasets. Therefore, the anatomical and rs-fMRI datasets must be centered at the same origin to ensure proper link between the computation and visualization stages.      2.4. Combining functional and structural connectivity    Figure  shows the different seeding options proposed to generate and visualize brain connectivity. In Figures  , one can see the traditional approaches for generating structural and functional connectivity using a seed-ROI (green box). From this ROI, one can generate structural connectivity (i.e., tractography Chamberland et al.,  , Figure  ) or functional connectivity (resting-state, Figure  ). One can also initiate streamlines from functional RSNs to visualize their underlying structural connections (resting-state-driven tractography, Figure  ). Figure  shows a unique method to generate rs-fMRI connectivity by extracting the average BOLD signal from the last   n   points of each streamline, which is then correlated with the rest of the brain (i.e., tractography-driven rs-fMRI). This technique produces a   streamline-specific   map revealing the underlying functional connectivity associated to the bundle of interest. This is further described in the following section.      2.5. Experiments     2.5.1. Resting-state networks validation    The first step toward assessing the validity of our interactive correlation method is to compare its results with traditional methods. Using three overlap metrics (defined in the next paragraph), we statistically compared   z   -score maps generated by our real-time technique implemented in the   Fibernavigator   with the ones generated offline using AFNI (Cox,  ). To do so, we first generated seven commonly reproducible RSNs (Beckmann et al.,  ), namely the default mode network (DMN), motor network, visual network, salience network, lateralized networks and auditory network, by interactively positioning a 10 \u00d7 10 \u00d7 10 voxels seed-ROI in seven associated anatomical regions (posterior cingulate cortex (PCC), primary somatosensory cortex, primary visual cortex, insula, lateral frontal cortex and primary auditory cortex, respectively). Anatomical localization (MNI space) of the seed regions can be found in Table  .    The same experiment was performed using AFNI's   3dfim   + command (Cox,  ), with the same seed-ROIs as input and converting the resulting correlation coefficients to   z   -scores. The generated RSNs were then statistically thresholded at different conventional   z   -scores (i.e., from 3.0 to 5.0) for statistical comparison. First, the Dice coefficient (D) (Dice,  ), as used in previous rs-fMRI studies (Kristo et al.,  ; Tie et al.,  ), is a similarity index that allows the quantification of the spatial overlap between two datasets F and G, and is defined as follows: D = 2 \u2223F\u2229G\u2223 /(\u2223F\u2223+\u2223G\u2223) = 2   a   /(2   a   +   b   +   c   ), where   a   is the number of voxels shared by the two datasets,   b   the remaining voxels of F that differs from G, and   c   the voxels that are present in G but not in F. The advantage of using this metric is that it ranges between 0 and 1. Thus, a perfect fit between two   z   -maps will lead to a Dice coefficient of 1, and 0 if there is no overlap at all. Next, the Jaccard coefficient (J) is computed by taking the intersection over the union between two volumes (J = \u2223F\u2229G\u2223 /(\u2223F + G\u2223) =   a   /(2   a   +   b   +   c   )). This metric expresses the relative volume overlap between the same RSN. The last metric is the correlation coefficient (\u03c1) between the unthresholded   z   -scores maps, which not only determines if there is spatial correspondence, but also compares the   z   -values between the two maps.      2.5.2. Tractography-driven resting-state fMRI    Having direct access to interactively adapt the tractography parameters, and more precisely to the stopping criteria (i.e., tracking mask), is a key factor when performing interactive structural connectivity. By interactively positioning a seed-ROI at a specific brain position, the tracking algorithm (Chamberland et al.,  ) performs dense 3D integration along the ODFs-extracted peaks field, thus generating streamlines in a bi-directional fashion. From there on, the 3D coordinates of the last   n   points of each streamline bundle (   n   = 3) were back-projected into fMRI-space to average their underlying BOLD signal and perform real-time correlations with the rest of the brain (Figure  ). Precisely, the mean signal is averaged from all the end points (both sides of the streamlines), unless they terminate outside of the fMRI volume. As the characteristics of the tractography seed-ROI changes (i.e., size, shape and position), the visualization updates. Functional networks associated to the streamlines of interest and their associated tractography parameters are thus revealed. These parameters consist in the tracking mask threshold (\u03c4), the step size (   s   ), the angular threshold (\u03b8), the number of seeds (#) and the minimum/maximum streamline length (\u03b4   min   \u2215\u03b4   max   ). To demonstrate the full potential of the technique, we reconstructed 9 well-known white matter bundles [cingulum (Cg), corpus callosum (CC body, genu and splenium), corticospinal tract (CST), optic radiations (OR), left and right superior longitudinal fasciculus (SLF), and the auditory radiation (AR) Catani and Thiebaut de Schotten,  ]. Seed-ROIs where interactively positioned at the midbody of each bundle and validated according to co-author and neurosurgeon D. Fortin.      2.5.3. Inter-subject variability    Tractography-driven resting-state was used to demonstrate how parameter selection alone may explain a portion of inter-subject variability typically observed in the DMN (Buckner et al.,  ). Using the   tratography-driven rs-fMRI   method described earlier, we interactively generated the right Cg of a randomly chosen subject (S6) and the underlying associated RSN (i.e., the DMN). Here, reconstruction parameters were set as follows: FA threshold (\u03c4) = 0.15, step size (   s   ) = 0.5 mm, maximum angle (\u03b8   max   ) = 35\u00b0, minimum length (\u03b4   min   ) = 60 mm, maximum length (\u03b4   max   ) = 200 mm with 1000 seeds evenly distributed within a 4 \u00d7 4 \u00d7 4 mm ROI located at the mid-coronal section of the Cg body. The rs-fMRI   z   -score and minimum cluster size (\u03b7   min   ) thresholds were 4.0 and 40, respectively. Then, we assessed inter-subject variability by applying those same parameters to the remaining subjects. Next, we regenerated the Cg and associated DMN networks on a individual basis. To achieve this, the reconstruction parameters were interactively set according to the neuroanatomy of each subjects, until the known anatomy of the DMN was retrieved (i.e., functional connectivity in the medial prefrontal cortex (mPFC), the PCC/precuneus, the left and right temporoparietal lobes, Buckner et al.,  ; Ward et al.,  ). The difference and percentage (%) change of each parameter were then computed, defined as follows: (   x   -   y   ) for the difference and ((   x   \u2212   y   ) /   y   \u00d7 100) for the % change, where   x   represents the subject-specific parameters and   y   the reference parameters extracted from S6.        3. Results     3.1. Resting-state networks validation    Figure  shows the seven RSNs used for comparison. As seen in Tables  ,  , the overlap metrics D, J and \u03c1, ranged between 0.691 and 0.983 for all RSNs indicating a good overlap regardless of the   z   -score threshold (i.e.,   z   >3.0, 4.0, and 5.0). The main finding here is that our real-time interactive implementation is equivalent to offline seed-based rs-fMRI analysis.      3.2. Tractography-driven resting-state fMRI    In this section, we present the results of our interactive way of computing rs-fMRI connectivity profiles, based on the extraction of the BOLD signal from the end points of the streamlines reconstructed by tractography. Bundle-specific tractography parameters and associated RSNs are shown in Table  . Figure  shows 9 selected fiber bundles and their end points used to structurally reconstruct rs-fMRI connectivity, namely the Cg and the DMN (   z   -score > 4.1), the CC-midbody and motor network (   z   -score > 4.9), the CST and the motor network (   z   -score > 4.8), the OR-left and the visual network (   z   -score > 4.4), the CC-splenium and the visual network (   z   -score > 5.0), the CC-genu and the salience network (   z   -score > 4.2), the left and right SLF for the lateralized networks (   z   -score > 4.6) and the auditory radiations (AR) underlying the auditory network (   z   -score > 4.0). Minimum cluster level for all RSNs was set to \u03b7   min   = 40 voxels (fMRI-space). Tractography seed-ROIs were interactively placed at the midbody of each bundle, indicated by the blue arrows in Figure  .    Tractography and rs-fMRI parameters where intentionally different for diverse regions of the brain to demonstrate the importance of having region-based parameters to explore structure-function relationship and intra-subject variability (Thiebaut de Schotten et al.,  ). These results show that some functional networks are linked by either direct structural connectivity (Figure  motor, salience, visual, lateral networks) or indirect structural connectivity (Figure  DMN, lateral networks) (van den Heuvel et al.,  ).      3.3. Inter-subject variability    Table  shows Cg-specific tractography parameters and rs-fMRI   z   -score thresholds used to extract the DMN across 10 subjects. Note the large variability, particularly in the maximum angle (\u03b8) and in the minimum streamline lenth (\u03b4   min   ). The difference and percentage (%) change of each parameter are displayed in Table  . The % changes in comparison with reference S6 range from \u221213.3 to 73.3% for the FA threshold, 20\u2013140% for the step size, \u00b142.9% for the angle threshold, 0\u201378.3% for the minimum length and \u00b120% for the   z   -score threshold. Figure  shows the reconstructed DMN and Cg for S6 (middle). Applying these subject-specific parameters on other subjects yielded a Cg bundle and DMN map that varied dramatically (Figure  , left representation of each subject). However, when interactively adjusting the tractography and rs-fMRI reconstruction parameters in a subject-specific manner, both the DMN and Cg were easily retrieved (Figure  , right representation of each subject). Red circles indicate example regions where one of the expected nodes could not be retrieved. Blue circles shows false-positive clusters successfully suppressed.    The results from Tables  ,  and Figure  show that the parameters needed to reconstruct the Cg varies dramatically across subjects. As a result, so does the DMN. Differences present in connectivity profiles show the importance of having subject-specific parameters when looking at structure-function relationships. Other parameters such as the number of seeds and the minimum rs-fMRI cluster size remained fixed.      3.4. Neurosurgical planning application    The proposed interactive functional and structural reconstruction methods were introduced at the pre- and intra-operative levels for a neurosurgical intervention. The case consists of a 31 years old male tumor patient with astrocytoma of grade III located near the motor area. Figure  shows a tractography-driven reconstruction of the DMN. Axial and coronal views of RGB map (Figure  ) show the deviated Cg (red circle) induced by the mass effect of the tumor. 3D reconstructions of the Cg (green), tumor (red), and the DMN (orange) are illustrated in Figure  . Figure  reveals functional connectivity near the anterior side of the tumor (mPFC). The Cg was reconstructed using the following standard tractography parameters: min. FA = 0.2,   s   = 0.5 mm, max. \u03b8 = 25\u00b0, \u03b4   min   = 90 mm, \u03b4   max   = 130 mm. The rs-fMRI   z   -score and cluster-size thresholds were set to 4.2 and 20, respectively. These parameters are comparable to state-of-the-art reconstruction parameters used for healthy subjects (Tables  ,  ) (Castellano et al.,  ; Tournier et al.,  ). The DMN was then generated by performing the temporal correlation of the BOLD signal underlying the last 3 points of each streamlines with all the other voxels of the brain.    Next, using   resting-state driven tractography   , we performed the instantaneous reconstruction of white matter fiber pathways using rs-fMRI clusters as seen in Figure  . First, the motor RSN was generated by interactively positioning a 10 \u00d7 10 \u00d7 10 mm seed-ROI within the motor cortex (Figures  ,   z   -score > 4.0). Next, tractography was initiated by evenly distributing 28000 seeds (1 seed per voxel) within the uncovered motor network clusters, thus allowing the reconstruction of the motor pathways (Figure  ). Tractography parameters were set as the following: min. FA = 0.2,   s   = 1.0 mm, max. \u03b8 = 35\u00b0, \u03b4   min   = 10 mm, \u03b4   max   = 200 mm. Generating such a connectivity profile offline would require of the user to (1) \u201cblindly\u201d select a seed-ROI and (2) observe the associated connectivity map before (3) using it as a seeding mask for tractography. One could also use independent component analysis (ICA) (Beckmann et al.,  ; Damoiseaux et al.,  ), which is another way of extracting multiple RSNs of the brain by statistically decomposing the acquired signal in a set of separate intrinsic components. It then still requires the appropriate selection of the component associated to the motor network, to finally inject it as a seeding mask for tractography.    We then extracted the BOLD signal of the tumor area by placing a 10 \u00d7 10 \u00d7 10 mm seed-ROI inside the tumor region (Figure  ) resulting in a functional segmentation of the astrocytoma (Figure  ). Next, using the functionally-driven map (dilated by 3 mm to cover the boundaries of the WM), tractography was initiated by interactively lowering the tracking threshold (FA) from conventional values (0.10\u22120.20, Castellano et al.,  ) to 0.08. This enabled the reconstruction of \u201clow-FA\u201d streamlines surrounding the tumor, as shown on Figure  . These streamlines, comprised the CST and CC, wrapped laterally around the tumor. Supplementary material available online at  illustrates the real-time interactive methods introduced in this section.       4. Discussion    In this study, we proposed a new interactive method to generate tractography-driven resting-state functional connectivity which generates bundle-specific functional networks. We also show the problems associated with the use of fixed reconstruction parameters across different brain regions and individuals. Our experiments reinforce the idea of using region- and subject-specific parameters based on the neuroanatomy of each individual. Finally, the proposed methods were applied in a neurosurgical context, which allowed the exploration of structure-function relationships to achieve   subject-specific medicine   .     4.1. Visualization and interactivity    Interactively coupling structural and functional imaging can provide great insights about brain connectivity, especially with the need to use rs-fMRI in surgical planning and other clinical applications, and the advent of human connectome studies. Some have proposed a tool for voxel-wise brain connectivity visualization, but the method requires the pre-calculation of a voxel-by-voxel correlation matrix (Dixhoorn et al.,  ) which can be hundreds of Gigabytes. In addition, GPU implementations have been developed for functional connectivity exploration (Eklund et al.,  ,  ) or for pre-surgical planning (B\u00f6ttger et al.,  ). The proposed methods, however, restricts the user from placing a seed-ROI at any point in the 3D space, which greatly reduces the level of interactivity. Subsequently, the user is limited to move the seed-ROI solely on 2D anatomical slices, thus only revealing activations present on displayed slices. Moreover, none of the aforementioned methods proposes the fusion of both rs-fMRI and dMRI data. The efficient AFNI toolbox (FATCAT) does propose a method for combining rs-fMRI and dMRI, but demands the precomputing of whole-brain tractography with fixed parameters (Cox,  ; Saad and Reynolds,  ; Taylor and Saad,  ). In addition, the proposed exploration tool does not allow direct superposition of RSNs and underlying streamlines, as the 3D brain hemispheres must be separated to achieve proper visualization.    In this paper, the mean frame-per-second (FPS) index is over 20 when solely activating the real-time tractography method with default parameters (anatomical space, 1000 seeds) (Chamberland et al.,  ). The same interactivity level (30+ FPS) applies for rs-fMRI connectivity, even when setting the   z   -score threshold to 0 (thus displaying thousands of correlation factors). For higher resolution resting-state acquisition (e.g., 3T scanner, assuming a 3 mm3voxel size, 250 volumes, TR \u2243 2 s, 8 min total), the interactivity would decrease in a \u201csoft\u201d real-time fashion. This means that as the number of time-points increase, the FPS index decreases. One potential solution would be to implement the correlation step on GPU (Eklund et al.,  ,  ). This would also allow the use of advanced techniques such as time-lag and partial correlation. For tractography-driven rs-fMRI, the interaction remains fluid as long as the maximum number of tractography seeds within the interactive ROI does not exceed 1000. When performing resting-state driven tractography, these 1000 seeds must thus be shared between the displayed fMRI clusters to maintain a high level of interactivity while moving the seed-ROI.    To the best of our knowledge, our proposed approach is the first study to interactively perform rs-fMRI connectivity based on tractography results. We strongly encourage the reader to visualize the following video to fully appreciate the contributions of this work and the necessity of an interactive method:  .      4.2. Seed-based vs. independant component analysis    Independent component analysis (ICA) is another way of extracting multiple RSNs of the brain by statistically decomposing the acquired signal in a set of separate intrinsic components (Beckmann et al.,  ; Damoiseaux et al.,  ). By doing so, ICA does not require any a priori assumption regarding the selection of a seed-ROI. However, the method is not well-suited for interactive exploration of RSNs due to its intensive mathematical decomposition algorithm, and still requires the selection of the desired networks manually or semi-automatically. Most functional connectivity tools are developed for group analysis, such as group-ICA (Beckmann et al.,  ), where group-components are regressed back to individuals, which can be heavy to use for single subject analysis. In addition, it has also been shown that seed-based and ICA methods provide comparable results when looking at rs-fMRI connectivity (Damoiseaux et al.,  ; Long et al.,  ; van den Heuvel et al.,  ; van den Heuvel and Hulshoff Pol,  ; Rosazza et al.,  ).      4.3. Offline validation with AFNI    The quantitative overlap measures (D and \u03c1) showed that our real-time interactive method can reproduce reliable networks and is comparable to state-of-the-art offline techniques. More specifically, the DMN, motor, visual, salience, and lateral-l networks showed the highest D overlap and consistency across different   z   -score thresholds (mean \u00b1 std, 0.960 \u00b1 0.004, 0.917 \u00b1 0.012, 0.928 \u00b1 0.003, 0.900 \u00b1 0.012, respectively). The lateral-r and auditory networks metrics showed slightly lower D metrics (0.881 \u00b1 0.052, and 0.842 \u00b1 0.034) while maintaining a high \u03c1 factor (0.980 and 0.976). The underlying correlation method is a possible source of variability. Our implementation performs the temporal correlation with all voxels of the brain, and only the positive-valued correlation factors are converted to   z   -score, while the remaining are set to 0.      4.4. Tractography-driven resting-state fMRI    Tractography-informed rs-fMRI connectivity is a promising new method that could reveal limits and indirect connections of multiple RSNs (e.g., functional regions that does not share a structural link). Having access to the tractography stopping criterion in real-time allows the instantaneous visualization of the effect of those parameters on the reconstructed networks. Tractography parameters where intentionally different across bundles. This demonstrates the importance of having region-based parameters, thus enabling the exploration of intra-subject variability. The main purpose of using a higher minimum streamline length criteria (\u03b4   min   > 60 mm) than default settings (e.g., 10 mm, Tournier et al.,  ) is to eliminate undesired short streamlines that would otherwise terminate prematurely within the white matter. Further research has to be conducted to see how the location of tractography end points impacts on rs-fMRI connectivity. The proposed technique could benefit from more thorough stopping criteria such as introducing anatomical priors (Smith et al.,  ; Girard et al.,  ), to ensure that all streamlines terminate within the gray matter. In addition, the step size and the number of terminal points per streamline used for correlation are also directly linked. One has to keep in mind that as the step size changes, the number of end points used to perform functional correlation should potentially be adapted accordingly. Interestingly, we also noticed that sometimes even a few streamlines reaching the appropriate cortex region are sufficient to generate a whole RSN. Overall, this method has the advantage of making good use of the tractography parameters by precisely adjusting them according to the desired network of interest. Specifically, this experiment showed that multiple RSNs can be recovered (Figure  ) using this original seeding strategy.      4.5. Inter-subject variability    The morphology of the brain substantially differs between individuals (Mueller et al.,  ). Traditional ways of coupling fMRI and dMRI often come down to reconstructing fiber pathways between distant fMRI activation regions. This may be problematic for two reasons: First, it assumes that fMRI should lead to dMRI fiber reconstruction, but it is not always the case. Actually, what do functional connectivity profiles look like when fMRI seed regions are determined via the end points of key white-matter bundles? Secondly, the vast majority of structure-function studies are analysed by assuming fixed reconstruction parameters across all subjects, despite the fact that this has been shown to lead to false-negatives (Chamberland et al.,  ).    We assessed the inter-subject variability associated to the structure-function relationship by importing a set of fixed parameters from an individual to the rest of our subjects. The right Cg bundle of each individual was reconstructed and the last 3 points of each streamline served as seed-ROI to perform correlations with the underlying BOLD signal present at these voxels. This allowed the recovery of the DMN in all cases, but with qualitative differences in their structural and functional connectivity profiles. The fixed set of parameters produced either artificially large functional connectivity spread across the brain, or could not fully recover the expected nodes of the DMN (mostly those located at the temporoparietal junction, Figure  ). Table  revealed differences in subject-specific parameters ranging from \u22120.02 to 0.11 for the FA threshold, 0.1\u20130.7 mm for the step size, \u00b1 15\u00b0 for the angle threshold, 0\u2013100 mm for the minimum length, and \u00b1 0.8 for the   z   -score threshold. This variability shows the importance of having subject-specific parameters when looking at brain connectivity across multiple subjects. These parameters are manually set based on anatomical knowledge. One could think of a machine-learning method that could qualitatively set each parameter based on the location and characteristics of the seed-regions.    Other adjustments such as the number of seeds, the minimum cluster size \u03b7   min   or the ROI's size, shape, and position should not be neglected. One should note that the proposed technique can robustly recover functional connectivity (e.g., DMN) from its underlying structural connectivity (e.g., Cg) across different subjects but can also extend to other well-known RSNs (e.g., motor, auditory, visual, salience, lateralized, and DMN networks, Figure  ).      4.6. Application in neurosurgical context    From a neurosurgical perspective, it could be interesting to look at the underlying functional network associated to an intra-operatively stimulated cortical site. This would require the preprocessing of multiple correlation maps associated to every seed-ROI, which may vary in size, shape and position. For subjects with brain tumors, the co-registration with templates is also an issue. Indeed, the use of predefined seed regions can thus be inefficient to explore rs-fMRI data due to distortions induced by the mass effect of the tumor. To overcome this problem, we have introduced an interactive method at both pre- and intra-operative levels. In this way, it is straightforward for the user to place a seed region (with adjustable size, shape and position) at any point of the brain, according to the will of the neurosurgeon. The use of the tractography-driven resting-state method enabled recovery of a functional network underlying a tumor-induced deviated structure (i.e., Cg).    We also showed that the BOLD signal can be used to characterize, and more specifically functionally segment brain tumors, as previously mentioned in the literature (Ulmer et al.,  ; Hou et al.,  ; Feldman et al.,  ). Moreover, the use of this functionally-driven map allowed us to initiate tractography and identify infiltrated streamlines within the surroundings of the tumor. By interactively lowering the tracking threshold in real-time (i.e., FA > 0.08), coherent structure was found. Such structure would not have been reconstructed if a higher FA threshold had been used (e.g., FA > 0.1, Castellano et al.,  ). Therefore, it is of tremendous importance to tune parameters in a subject-specific way also in neurosurgical applications since this leads to more reliable pathway estimates. Hence, neurosurgeries should be individually adapted for the neuroanatomy of each patient. Another potential application of the proposed methods is for pre- and intra-operative planning for patients with epilepsy where mapping the epileptic foci and its surrounding connections is critical (Liu et al.,  ; Otte et al.,  ; Taimouri et al.,  ; Tax et al.,  ). For neuro-degenerative diseases, we believe that our approach is important to more accurately visualize the alternation of a particular RSN. For instance, our software package could be used to freely explore which parameters (correlation threshold, seed location) need to be adjusted to highlight the often-observed DMN. By doing so, the user could then use this information as starting point for group analysis.       5. Conclusion    In this paper, we proposed a method for probing functional and structural connectivity in a 3D interactive fashion. By extracting the BOLD time series from the end points of a streamline and performing real-time correlations with the rest of the brain, we demonstrated that multiple well-known RSNs can be recovered. This provides more insight on the structure-function relationship in a subject-specific aspect. It can also serve as a quality assurance technique at the single subject level prior to launching massive analysis. Importantly, researchers should be careful when using fixed parameters across multiple subjects, which potentially rules out most of the inter-individual variability. In conclusion, our proposed method can be used for clinical applications and is achievable without complex GPU programming. Future development will include a more thorough assessment of the white matter and gray matter characterization by adding anatomical priors to the tractography algorithm (Girard et al.,  ). Supplementary video data showing the real-time interactive reconstruction of brain networks can be found online at:  .     Conflict of interest statement    The authors declare that the research was conducted in the absence of any commercial or financial relationships that could be construed as a potential conflict of interest.       Supplementary material    The Supplementary Material for this article can be found online at:", "utf8_text_md5_checksum": "c6b8b84a3d7637808031beeb7df56666"}
