{"text": "Honari, Hamed and Choe, Ann S. and Lindquist, Martin A.\nNeuroimage, 2020\n\n# Title\n\nEvaluating phase synchronization methods in fMRI: A comparison study\nand new approaches\n\n# Keywords\n\nInstantaneous phase synchronization\nFunctional connectivity\nResting-state fMRI\nCircular statistics\nPhase synchronization detection\nTime-varying phase synchronization\n\n\n# Abstract\n \nIn recent years there has been growing interest in measuring time-varying\nfunctional connectivity between different brain regions using resting-state\nfunctional magnetic resonance imaging (rs-fMRI) data. One way to assess the\nrelationship between signals from different brain regions is to measure their\nphase synchronization (PS) across time. There are several ways to perform such\nanalyses, and we compare methods that utilize a PS metric together with a\nsliding window, referred to here as windowed phase synchronization (WPS), with\nthose that directly measure the instantaneous phase synchronization (IPS). In\nparticular, IPS has recently gained popularity as it offers single time-point\nresolution of time-resolved fMRI connectivity. In this paper, we discuss the\nunderlying assumptions required for performing PS analyses and emphasize the\nimportance of band-pass filtering the data to obtain valid results. Further, we\ncontrast this approach with the use of Empirical Mode Decomposition (EMD) to\nachieve similar goals. We review various methods for evaluating PS and introduce\na new approach within the IPS framework denoted the cosine of the relative phase\n(CRP). We contrast methods through a series of simulations and application to\nrs-fMRI data. Our results indicate that CRP outperforms other tested methods and\novercomes issues related to undetected temporal transitions from positive to\nnegative associations common in IPS analysis. Further, in contrast to phase\ncoherence, CRP unfolds the distribution of PS measures, which benefits\nsubsequent clustering of PS matrices into recurring brain states. \n \n\n# Body\n \n## Introduction \n  \nIt was previously assumed that functional connectivity (FC) in the brain was\nstatic during the course of a single resting-state functional magnetic resonance\nimaging (rs-fMRI) run. Recently, however, several studies ( ;  ; Hutchison et al., 2013a;  ;  ;  ;  ) have\npointed to dynamic changes in FC taking place in a considerably shorter time window\nthan previously thought (i.e., on the order of seconds and minutes). Several methods\nhave been proposed to investigate such time-varying connectivity (TVC). These\ninclude the widely-used sliding-window approach ( ; Hutchison et al., 2013a; 2013b;  ), change point analysis ( ;  ;  ), point process analysis ( ), co-activation patterns (CAPs) ( ), transient-based CAPs\n( ), time series models ( ), time-frequency analysis ( ), and variants of hidden Markov models (HMMs)\n( ;  ;  ;  ). Despite development of these promising approaches, estimation of\nTVC remains a challenging endeavor due to the low signal-to-noise ratio (SNR) of the\nblood oxygen level dependent (BOLD) signal and the presence of image artifacts and\nnuisance confounds (Hutchison et al., 2013a;  ;  ). \n\nThe term   synchronization   refers to the coordination in the\nstate of two or more systems that can be attributed to their interaction (or\ncoupling) ( ). Recently,\nphase synchronization (PS) methods were proposed as a means of measuring the level\nof synchrony between time series from different regions of interest (ROIs) in the\nbrain ( ;  ;  ). Typically, the phase of a particular time series is computed at\neach time point through the application of the Hilbert transform, and used to\nevaluate the phase difference between various time series. Two time series in\nsynchronization will maintain a constant phase difference. In this study, we\ndifferentiate between methods that combine a PS metric with a sliding window\napproach, referred to as windowed phase synchronization (WPS), with those that\ndirectly measure PS at each time point, referred to as instantaneous phase\nsynchronization (IPS). \n\nThe first class of methods (WPS methods) uses metrics that provide a single\nomnibus measure of the phase synchronization between two time series obtained using\nthe Hilbert transform. This approach is similar to how correlations provide an\nomnibus measure of the linear relationship between time series (analogous to the\nstatic correlation used in FC). In this approach, a sliding window technique is used\nto compute the metric locally within a specific time window. As the window is\nshifted across time, one can obtain a time-varying value of the measure of interest\n(i.e., the dynamic synchronization between two time series). The use of Phase\nLocking Value (PLV) ( ;\n ;  ) to capture time-varying\nrelationship between a pair of signals has recently been used in this context ( ). In this paper, we\npropose two other measures that can capture the time-varying relationship between a\npair of signals: circular-circular correlation ( ;  ), and toroidal-circular correlation ( ). Importantly, this class of methods\nsuffers from similar issues as sliding-window correlations, such as the need to\nselect an   a priori   window length for analysis. \n\nThe second class of methods (IPS methods) directly analyzes the instantaneous\nphases extracted using the Hilbert transform. In recent years there has been growing\ninterest in using IPS methods in neuroimaging, with the bulk of the work applied to\nMEG and EEG data. However, several studies have also applied IPS methods to fMRI\ndata. For instance,   used\nIPS methods to analyze task-activated fMRI data. However, the lack of narrow\nband-pass filtering in the study\u2019s analysis pipeline brings into question the\nvalidity of the results.  \nstudied the spectral characteristics of resting state network (RSN) and suggested\nthat it is important to consider the IPS between various RSNs at different\nfrequencies.   proposed\nusing IPS as a measure of TVC. Finally,   examined the relationship between IPS and Correlation-based\nSliding Window (CSW) techniques and observed a strong association between the two\nmethods when using absolute values of CSW. Benefits of using an IPS approach is that\nit offers single time-point resolution of time-resolved fMRI connectivity, and does\nnot require choosing an arbitrary window length. \n\nIn this paper, we discuss the concept of phase synchronization in the context\nof fMRI, with a particular focus on TVC. We begin by reviewing the framework for\ncomputing the phase from time series data using the Hilbert transform, and discuss\nthe importance of band-pass filtering the data to accurately estimate the\ninstantaneous phases. In the EEG literature, an alternative to band-pass filtering\nis to use empirical mode decomposition (EMD) ( ) as a preprocessing step. Here we contrast the two approaches in the\ncontext of analyzing PS in the fMRI setting. We continue by introducing a number of\ndifferent methods for evaluating phase synchronization. We focus both on methods\nalready in common use, such as the phase locking value and phase coherence, as well\nas methods new to the fMRI literature, such as circular-circular correlation and\ntoroidal-circular correlation ( ). Finally, we propose a new variant of phase coherence, denoted the\nCosine of the Relative Phase (CRP), that can be used to compute IPS. We contrast\nthese methods through a series of simulations and application to two rs-fMRI data\nsets. The first consists of test-retest data with a temporal resolution of 2\n  s  , while the second is data from the Human Connectome Project\nwith a temporal resolution of 0.72   s  . \n\n\n## Methods \n  \n### A framework for computing instantaneous phase \n  \nTo obtain the instantaneous phase ( ) of an arbitrary real signal\n  x  (  t  ) one must first construct an analytic\nsignal:   where   and   represents the Hilbert transform. This signal\ncan in turn be re-expressed as follows:   where   represents the envelope and\n  the instantaneous phase. \n\nHere   x  (  t  ) is assumed to satisfy\nBedrosian\u2019s Product Theorem, which states that a band-limited signal can\nbe decomposed into the product of envelope and phase when their spectra are\ndisjoint. This holds if the signal of interest is first narrow-banded by\napplying a band-pass filter. \n\nThere are two important considerations when choosing the appropriate\nfilter to apply. First, it should not corrupt the phase information in the\nsignal. Thus, it is important to use a filter that does not shift the phase. One\nclass of filters that accomplishes this goal are zero-phase filters. Second, the\nwidth of the frequency band must be sufficiently narrow. The narrower the band,\nthe closer the signal will be to a mono-component signal and the Hilbert\ntransform will produce an analytic signal with meaningful envelope and phase.\nThe choice of appropriate band widths in this context have been investigated in\nprevious studies of fMRI data. For example,   examined band-pass filtering of fMRI\ndata using various frequency bands in the range of 0.01 \u2013 0.13\n   H   z   and reported consistent results for\nphase statistics at each frequency band.   compared using a narrow band-pass filter\n(0.03 \u2013 0.07    H   z  ) with a wider band-pass\nfilter (0.01 \u2013 0.1    H   z  ), and found that the\nnarrow-band data yielded stronger associations between the results of CSW and\nIPS analyses. \n\nA schematic framework for obtaining the instantaneous phase\nsynchronization is shown in  . \n\nConsider that a pair of time series\n  x  (  t  ) and  , from two different ROIs are filtered using a\nnarrow band-pass zero-phase filter,  . and denote the filtered data by\n  and   respectively, i.e.,   Here * represents the convolution operator. \n\nIf Bedrosian\u2019s theorem holds, the analytical signals of the\nnarrow-banded time series can be expressed as the product of instantaneous\nenvelope and instantaneous phase:   Here the subscript   a   refers to analytical\nsignal. Throughout, we assume that   and   are the phase time series extracted from a pair\nof time series   x  (  t  ), and\n  y  (  t  ). Using the instantaneous phases,\nsynchronization can be assessed by studying their differences. \n\nAn alternative to band-pass filtering is to use EMD. Here one decomposes\nthe time series into a sum of oscillatory modes referred to as intrinsic mode\nfunctions (IMF) that correspond to different frequency contents in the time\nseries. EMD provides a data-driven signal decomposition and does not require an\n  a priori   defined basis system. The first IMF consists of\nthe largest frequency oscillation present in the signal, and each subsequent IMF\nconsists of increasingly smaller frequency oscillations than the those\npreviously extracted. A more detailed description of bivariate EMD (BEMD), which\nis used in this paper, can be found in the  . In the\ncontinuation, we refer to this as the BEMD-based PS framework to differentiate\nit from the framework described above. \n\n\n### Methods for assessing phase synchronization \n  \nNext, we describe how to measure PS based on the extracted phase time\nseries. We discriminate between methods that utilize a PS metric together with a\nsliding window approach (WPS) from those that directly measure IPS. \n\n#### Windowed phase synchronization \n  \nThe first class of methods, place a measure of PS across two time\nseries within a sliding window framework. Here we describe this approach\nusing PLV, circular-circular correlation, and toroidal-circular\ncorrelation. \n\n##### Phase Locking Value \n  \nThe PLV is a classic metric for assessing phase synchronization\nbased on quantifying to what extent the two signals are phase locked.\nPLV has found widespread use in the analysis of MEG/EEG data ( ;  ). This\nnotion of synchronization can be expressed as follows:   Here the integers   m   and\n  n   are the synchronization indices and\n  the generalized phase difference time\nseries. In this paper, we assume   m   =   n  \n= 1 and drop the indices and let  . \n\nUsing the instantaneous phase difference of the signals at each\ntime point, the PLV can be computed as follows:   where the operator   denotes averaging over time. If the\npair of signals are unsynchronized, then   and   follows a uniform distribution;\notherwise, if the pair are synchronized,\n   PLV    is constant and equal to 1 ( ). \n\nTo compute PLV within a sliding window framework, for each time\nwindow of length   \u2113  , the PLV between the pair of\nthe signals can be obtained using  . This approach has been\npreviously used for assessing the episodes of elevated gastric-BOLD\nsynchronization by   in the study of stomach-brain synchrony. \n\nNext, we introduce two other measures in WPS approach that to\nour best of knowledge have not been used to assessing the time varying\nphase synchornization in a sliding window fashion. \n\n\n##### Circular-Circular Correlation \n  \nThe instantaneous phase obtained from each time series are\ndirectional data and follow a circular distribution. In this context,\nthe use of the standard Pearson correlation coefficient is no longer\nappropriate. Instead, a more suitable measure is circular-circular\ncorrelation ( ;  ), defined as follows:  \n\nIn the equation above,   and  , while   \u03bc   and\n  \u03bd   represent the mean directions of\n  and  , respectively. Thus, the terms\n  and   can be interpreted as the deviations of\n  and   from their corresponding mean\ndirections. \n\nThe circular-circular correlation provides a measure of the\nstatic interdependence between the two phase time series. It can also be\nused within the sliding windows framework to investigate the\ntime-varying PS. This can be expressed as:   where   and   represent the estimated time-varying\nmean of the two phase time series over the sliding window. It is\nimportant to note in the context of directional statistics,\n  is computed as follows ( ;  ):  \n\nThis formulation can be understood by representing each\ndirectional variable on a unit circle (r = 1) in the polar coordinate\nsystem (r,   \u03d5  ). Re-expressing to the Cartesian\ncoordinate system (x, y), we can write   and  , for  . Thus,  ,  , and the mean direction thus can be\nwritten as expressed in  . Here   is computed analogously. \n\n\n##### Toroidal-Circular Correlation \n  \nIn a critique of circular-circular correlation,   argued that the sine of an\nangle contains less information than the angle itself, as multiple\nangles can take the same sine value. Furthermore, since the sine\nfunction is not monotone within an interval of\n  \u03c0  , this may lead to unreasonable results. To\ncircumvent these issues, they introduced a circular correlation\ncoefficient for bivariate directional data on a torus, which is the\nequivalent to the product of two circles ( ;  ). \n\nTo elaborate, let   (or similarly  ) and   (or  ) be two circular data points and set\n ,  , so  . When   OR  , by convention the direction from\n  to   is considered to be clockwise. When\n  OR  , the direction is considered\ncounter-clockwise. The same definition holds for\n  and  . \n\nLet  , then the order function can be\nexpressed as follows:  \n\nNow, let us assume that   and   are independent. The toroidal-circular\ncorrelation is then defined as follows:  \n\nNote that   can take values between \u22121 to\n+1. Based on this definition, the two variables\n  \u03d5   and\n  \u03d5   move on the circumference\nof the torus in the same direction if  , making  . Similarly,   indicates that the two variables are\nmoving in opposite directions. \n\nAn estimator can be obtained as follows:  \n\nThe main advantage of using toroidal-circular correlation is\nthat no information about the angles are lost. Thus, the estimator\ncircumvents problems due to the non-monotonicity of the sine function\nthat could result in irregular estimation when using the\ncircular-circular correlation. It can be calculated within a sliding\nwindow framework similar to the previous sections. \n\n\n\n#### Instantaneous phase synchronization \n  \nThe second class of methods are based on directly working with the\ninstantaneous phases of two time series. Here we focus on phase coherence\n( ;  ), which has already found wide\nusage in the field, and the cosine of the relative phase, introduced for the\nfirst time in this work. \n\n##### Phase Coherence \n  \nThe phase coherence at each time point is defined as follows:\n  Here the absolute value of the sine of the relative\nphase differences is included to account for phase wrapping and resolve\nissues with phase ambiguity over time. Note that the range of the values\nobtained using this metric will take values between 0 and 1, where 0\nimplies no phase coherence and 1 corresponds to maximal phase\ncoherence. \n\nA shortcoming of this approach is that it discards information\nabout the direction of the relationship as  . As these values vary between 0 and 1,\n  \u03a8  (  t  ) as defined in   does not capture\nnegative association (i.e., when signals are in anti-phase). This may\nhelp explain why   found that the association between IPS and CSW\nanalysis was strongly dependent on negative correlations obtained from\nthe CSW analysis, and that the association increased when comparing the\nabsolute values of the correlations. In addition, it explains why their\nanalysis was unable to capture temporal transitions from positive to\nnegative associations, and vice versa, that appeared in the CSW\nanalysis. \n\n\n##### Cosine of the Relative Phase \n  \nTo circumvent the issues outlined above, we propose a\nmodification of phase coherence that takes temporal transitions into\naccount and preserves the correlational structure in the data. This can\nbe achieved by not taking the absolute value of the phase difference and\nusing a cosine function instead of a sine function. We refer to this\nmeasure as the cosine of the relative phase (CRP), defined as follows:\n  Notably, the range of the values obtained using this\nmetric take values between \u22121 and 1, and is therefore directly\ncomparable to standard correlation values. \n\nThe CRP approach avoids phase unwrapping and takes phase\nambiguity into consideration. When the instantaneous phase of two\nsignals are similar to one another (i.e.,  ), CRP yields a value close to 1. When\nthe phases are dissimilar but in the same direction, their relative\nphase difference is bounded between  , which is the range where the cosine\nfunction is positive. As the phases become orthogonal to one another,\nCRP approaches 0 indicating a lack of coherence. Similarly, the CRP\ncaptures negative associations between phases. If the phase difference\nis greater than \u00b1  \u03c0  /2, this results in\nnegative values of the cosine function. Thus, using CRP as a measure of\nphase synchrony helps overcome the issue of detecting temporal\ntransitions from positive to negative associations (or vice-versa), and\npreserves the positive and negative dependence in the data. \n\n\n\n\n### Simulations \n  \nIn this section we introduce three simulations designed to compare the\nmethods presented in   for the\ntwo different classes of PS analysis. The first investigates their performance\nin a null setting, while the second and third investigate PS measures when two\nsinusoidal signals have the same frequency but differing phase shifts. For all\nthree simulations data was generated with a sampling frequency of 1/  T\nR  , where   T R   represents the repetition time of an\nfMRI experiment. To be comparable with the main rs-fMRI data set used in this\npaper we chose   T R   = 2 seconds. \n\nFor each simulation we computed WPS values using the PLV,\ncircular-circular correlation, and toroidal-circular correlation, and IPS values\nusing phase coherence and the CRP method. All simulations were repeated 1000\ntimes, and the mean and variance of the PS measured at each time point was used\nto construct a 95% confidence interval. Furthermore, the effect of different\nwindow lengths in the WPS analysis was evaluated using three different window\nlengths (30, 60, and 120 TRs). \n\nTo illustrate the necessity of band-pass filtering the data, PS analysis\nwas performed on the simulated data both before and after band-pass filtering it\nin the range [0.03, 0.07]    H   z  . Throughout we used\na 5th order Butterworth filter. The zero-phase version of this filter is\nimplemented in MATLAB by filtering backward in time using MATLAB\u2019s\nfiltfilt function to cancel out the phase delay introduced by this filter. \n\nFor comparison purposes we repeated the simulations using BEMD,\ndescribed in  , in place of the band-pass filtering. Using the BEMD-based PS\nframework, the pairwise intrinsic mode functions (IMF)s are obtained and PS\nmeasures are computed on the IMF pair whose frequency is closest to central\nfrequency of 0.05 Hz which corresponds to the peak of the power spectrum. \n\n#### Simulation 1: \n  \nTo simulate time series with independent phase dynamics, we\ngenerated two independent random signals from a Gaussian distribution with\nmean 0 and standard deviation 1. Using the logic of surrogate data testing,\nwe generated surrogate data under the assumption of no relationship between\nthe phase from the two signals. To achieve this goal we used cyclic phase\npermutation (CPP) surrogates ( ), constructed by reorganizing the cycles within the\nextracted phase of the signals. This destroys any phase dependence between\nthe pair, whilst preserving the general form of the phase dynamics of each\ntime series. For this simulation, the 1000 realizations of signal pairs were\ngenerated using CPP surrogates. \n\n\n#### Simulation 2: \n  \nHere we generated two sinusoidal signals with the same frequency,\nbut with a time-varying phase shift corresponding to a ramp function. To\nelaborate, consider two sinusoidal signals\n  x  (  t  ) and\n  y  (  t  ). Let\n  x  (  t  ) be the reference signal with an\nangular frequency of   \u03c9   and phase\n  \u03c6  (  t  ). Further,\nlet   y  (  t  ) have the same angular frequency\nbut with phase   \u03c6  (  t  ).\nThe signals can be expressed as follows:  \n\nWithout loss of generality, let   and   be a ramp function,   The time series can then be expressed as follows:\n  Throughout,   rad / s   with   f   = 0.05\n   H   z  , and the transition is set to\noccur at   t   = 170   s  . The noise\nterms   \u03b5   and\n  \u03b5   are Gaussian white noise with mean\n0 and standard deviation 1. \n\nTo summarize, the two signals start out phase synchronized and\nremain in this state up to   t   = 170\n  s  . After which the phase difference starts linearly\nincreasing and transition into a non-synchronized state. \n\n\n#### Simulation 3: \n  \nHere we generated two sinusoidal signals with the same frequency,\nbut with a time-varying phase shift corresponding to a sigmoid function. As\nin the previous simulation, data was generated according to  . Here we let\n  \u03c6  (  t  ) = 0 and\n  \u03c6  (  t  ) be a\nsigmoid function, i.e.   Hence, the time series can be expressed as follows:\n  Throughout, we set   a   =\n2  \u03c0  ,   b   = \u22120.01.\n  t   = 170, and   rad / s   with   f   = 0.05\n   H   z  . The noise terms\n  \u03b5   and\n  \u03b5   are Gaussian white noise with\nmean 0 and standard deviation 1. \n\nTo summarize, the signals are initially in phase, after which the\namount of phase shift gradually increases. This continues until\n  t   = 170 when the pairs are in anti-phase\nsynchronization. Thereafter, the signals gradually return to being in phase.\nThe transition between the phase of the signals from 0 to\n2  \u03c0   occurs smoothly and monotonically\nincreasing. \n\n\n\n### Application to Kirby21 dataset \n  \n#### Image acquisition \n  \nWe used the Multi-Modal MRI Reproducibility Resource from the F.M.\nKirby Research Center, commonly referred to as Kirby21. It includes data\nfrom 21 healthy adults scanned on a 3T Philips Achieva scanner designed to\nachieve 80 mT/m maximum gradient strength with body coil excitation and an\neight channel phased array SENSitivity Encoding (SENSE) ( ) head-coil for reception.\nAll subjects completed two scanning sessions on the same day, between which\nthey briefly exited the scan room. A T1-weighted (T1w)\nMagnetization-Prepared Rapid Acquisition Gradient Echo (MPRAGE) structural\nrun was acquired during both sessions (acquisition time = 6\n  min  , TR/TE/TI = 6.7/3.1/842   ms  ,\nresolution = 1 \u00d7 1 \u00d7 1.2   mm  ,\nSENSE factor = 2, flip angle = 8\u00b0 ). A multi-slice SENSE-EPI pulse\nsequence ( ;\n ) was used\nto acquire two rs-fMRI runs during each session. Each run consisted of 215\nvolumes sampled every 2 s at 3   mm   isotropic spatial\nresolution (acquisition time: 7 min. TE = 30 ms, SENSE acceleration factor =\n2. flip angle = 75\u00b0, 37 axial slices collected sequentially with a 1\n  mm   gap). Subjects were instructed to rest comfortably\nwhile remaining still. One subject was excluded from further analyses due to\nexcessive head motion. For a more detailed description of the acquisition\nprotocol see  . \n\n\n#### Image processing \n  \nThe data was preprocessed using SPM8 (Wellcome Trust Centre for\nNeuroimaging, London, United Kingdom) ( ) and custom MATLAB (The Mathworks, Inc.,\nNatick, MA) scripts. Five initial volumes were discarded to allow for the\nstabilization of magnetization. Slice-time correction was performed using as\na reference the slice acquired at the middle of the TR. Rigid body\nrealignment transformation was performed to adjust for head motion.\nStructural runs were registered to the first functional frame and normalized\nto Montreal Neurological Institute (MNI) space using SPM8\u2019s unified\nsegmentation-normalization algorithm ( ). The estimated nonlinear spatial\ntransformations were applied to the rs-fMRI data, which were high-pass\nfiltered using a cutoff frequency of 0.01    H   z  .\nThe rs-fMRI data was spatially smoothed using a 6   mm  \nfull-width-at-half-maximum (FWHM) Gaussian kernel, which is twice the\nnominal size of the rs-fMRI acquisition voxel. \n\nThe Group ICA of fMRI toolbox (GIFT) ( ) was used to\nestimate the number of independent components (ICs) present in the data,\nperform data reduction via principal component analysis (PCA) prior to\nindependent component analysis (ICA), and perform group independent\ncomponent analysis (GICA) ( ) on the PCA-reduced data. The number of ICs was estimated\nusing the minimum description length (MDL) criterion ( ). Across subjects and sessions,\n56 was the maximum estimated number of ICs and 39 the median. Prior to GICA,\nthe image mean was removed from each time point for each session, and three\nsteps of PCA were performed. Individual session data were reduced to 112\nprincipal components (PCs), which were concatenated within subjects in the\ntemporal direction and further reduced to 56 PCs. Finally, data were\nconcatenated across subjects and reduced to 39 PCs. The dimensions of the\nindividual session PCA (112) was chosen by doubling the estimated maximum IC\nnumber (56), to ensure robust back-reconstruction ( ;  ) of subject- and session-specific spatial\nmaps and time courses from the group-level ICs. ICA was repeated on these 39\ngroup-level principal components 10 times, utilizing the Infomax algorithm\nwith random initial conditions ( ). The resulting 390 ICs were clustered across\niterations using a group average-link hierarchical strategy, and 39\naggregate spatial maps were defined as the cluster modes. Subject- and\nsession-specific spatial maps and time courses were generated from these\naggregate ICs using the GICA3 algorithm. \n\nThe spatial distribution of each IC was compared to a publicly\navailable set of 100 unthresholded t-maps of ICs estimated using rs-fMRI\ndata collected from 405 healthy participants ( ). These maps were pre-classified as\nresting-state networks (RSNs) or noise by a group of experts, and the 50\ncomponents classified as RSNs have been organized into seven functional\ngroups, namely visual (Vis), auditory (Aud), somatomotor (SM), default mode\n(DMN), cognitive-control (CC), subcortical (SC) and cerebellar (Cb)\nnetworks. For each spatial map, we calculated the percent variance explained\nby each of the seven sets of RSNs. The functional assignment of each Kirby\ncomponent was determined by the set of components that explained the most\nvariance, and if the top two sets of RSNs explained less than 50% of the\nvariance in a Kirby component, the component was labeled as noise. In total\n21 of the 39 components were assigned to a RSN. Subject- and run-specific\ntime series from these components served as input for our analyses. \n\n\n#### Analysis \n  \nThe Kirby21 dataset consists of 21 ROIs measured over 210 time\npoints for 20 subjects in two repeated sessions. The framework described in\n  (see  ), using a band-pass filter with range\n[0.03, 0.07]    H   z  , was applied to the data for\neach session separately to compute the region-wise instantaneous phase for\neach of the 20 subjects. For each pair of subject-specific phase time\nseries, we applied the WPS and IPS methods. We also applied CSW for\ncomparison purposes. To facilitate comparison between the WPS and CSW\nmethods, we used a common window length of 28 time points. We further\ncompared the results with a prewhitened Correlation-based Sliding Window\n(PW-CSW) assuming an AR(1) model. This comparison was performed as a\nprevious study ( )\nshowed that prewhitening the data prior to analysis can lower the variance\nof the estimated TVC and improve brain state estimation. \n\nFor each of the two sessions, application of each method gave rise\nto a subject-specific 21 \u00d7 21 \u00d7 210 array of PS measures.\nFollowing the approach of Allen and colleagues ( ), we applied\n  k  -means clustering to estimate recurring brain states\nacross subjects. First, we reorganized the lower triangular portion of each\nsubject\u2019s dynamic correlation data into a matrix of dimension 210\n\u00d7 210. Here the row dimension corresponds to the number of elements\nin the lower triangular portion of the matrix (i.e., 21(21 \u2212 1)/2),\nand the column dimension corresponds to the number of time points. Then we\nconcatenated the data from all subjects into a matrix with row dimensions\n210 and column dimensions (210 \u00d7 20 = 4200). Finally, we applied\n  k  -means clustering to the concatenated data, where each\nof the resulting cluster centroids were assumed to represent a recurring\nbrain state. The   k  -means clustering was repeated 200 times,\nusing random initialization of centroid positions, in order to increase the\nchance of escaping local minima. In this study, we set the number of\ncentroids to two, representing two distinct brain states, as determined\nusing the Davies-Bouldin Index (DBI) ( ). This is consistent with the number of the\nclusters for this dataset used in previous studies by   and  . In order to validate the\nreproducibility of the brain states estimated using each of the phase\nsynchronization measures, the results obtained from each of the two sessions\nwere further compared and contrasted. \n\n\n\n### Application to the Human Connectome Project (HCP) \n  \nTo validate the results obtained using the Kirby21 dataset, we applied\nthe proposed methodology to a second rs-fMRI dataset from the Human Connectome\nProject (HCP). This data set has a different repetition time and scan length\nthan the Kirby21 data, thus providing valuable insight into the performance of\nour method in this alternate setting. We used 50 subjects from the Human\nConnectome Project 500 Parcellation+Timeseries+Netmats (HCP500-PTN) release\n( ) to evaluate\nthe performance of the PS measures. For space reasons, the image acquisition,\nimage processing and analysis are discussed in   of the  . \n\n\n\n## Results \n  \n### Simulation 1 \n  \n shows a single realization\nof Simulation 1 for illustration purposes. Panel (a) shows a randomly generated\npair of time series, and (b) the extracted instantaneous phases between the two\ntime series at each time point. Since this is null data, the phase difference\nshould vary uniformly in the interval [0, 2  \u03c0  ] as\nillustrated in Panels (c) and (d). \n\n shows a summary of the\nresults for 1000 surrogate data sets with the analysis performed on the data\nprior to band-pass filtering. The mean and 95% confidence interval for each\nmeasure are shown at each time point. Results for the WPS measures (Panels\n(a)\u2013(c)) are shown for each window length (30, 60, and 120 time points).\nThe results illustrate that all measures of PS are roughly constant across\ntime. \n\nNote that measures such as PLV and phase coherence take values between 0\nand 1. The mean value using phase coherence is roughly 0.35 (Panel (d)), which\nis consistent with the results obtained using PLV for a window size of 60 (Panel\n(a)). As the window size decrease, the value of PLV tends to be lower. In\ncontrast, circular-circular correlation, toroidal-circular correlation, and CRP\nall take values between \u22121 and 1 The mean of the CRP is 0 at each time\npoint (Panel (e)), which is consistent with the results of the WPS obtained\nusing circular-circular and toroidal-circular correlation (Panels (b) and\n(c)). \n\nIt is important to note that phase coherence and CRP preserve the\ntemporal resolution of the phase difference as they are not estimated using a\nsliding window. However, this appears to come at the cost of increased\nvariability as indicated by the relatively wider 95% confidence intervals. \n\nThe effect of the chosen window length on various WPS measures shows\nthat for this simulation as the window size increases, the estimates converge\ntowards their true values (i.e., 0 for circular-circular correlation and\ntoroidal-circular correlation). The average bias and variance of each method is\nreported in  . \n\n shows the comparison between\nvarious measures of PS used on the surrogate data after band-pass filtering. The\nresults indicate that synchronization measures remain roughly constant across\ntime. However, the WPS measures (Panels (a)\u2013(c)) show a noticeable\ndifference compared to the results without band-pass filtering. Significantly,\nthe results of the WPS measures show inflated values, indicating a higher degree\nof phase synchronization than would be expected in a null setting. PLV,\ncircular-circular correlation, and toroidal-circular correlation take values\naround 0.84, 0.53, and 0.62, respectively. These is driven by the fact that both\nsignals have a center frequency of 0.05    H   z   after\napplying band-pass filtering, leading to a situation where the signals are\nconstrained to remain phase locked throughout the time course. The IPS measures\nare not similarly affected. The mean value using phase coherence is again\nroughly 0.35 (Panel (d)), and the mean of the CRP is 0 at each time point (Panel\n(e)). Both values are roughly equivalent to those seen before band-pass\nfiltering. The average bias and variance of each method is reported in  . \n\n in\nthe   show the results of this simulation using the BEMD-based PS\nframework. The results are similar to those obtained using band-pass filtering,\nwith the exception that the variance of the estimates are slightly higher; see\n . This can\nbe explained by the well-known sensitivity of the EMD-based approach to noise\n( ;  ;  ), which in turn leads to a higher\nvariance of the phase synchronization measures. \n\n\n### Simulation 2 \n  \n and   illustrate the results of Simulation 2 performed on\nthe data before and after band-pass filtering, respectively. Recall that in this\nsimulation the two signals are designed to have the same phase up to time\n  t   = 170, after which a phase shift is introduced that\nvaries linearly from 0 to 4  \u03c0   (see  ). Thus, the signals should gradually move in\nand out of phase during the second half of the time course. Here the signals\nwill be in-phase when the phase difference is 2  \u03c0   and\n4  \u03c0  , and in anti-phase when the difference is\n  \u03c0   and 3  \u03c0  . \n\nThe costs of not band-pass filtering the data are apparent in  , as all five of the methods return\nresults consistent with those seen in the null setting. None of the methods does\na good job of either detecting the fact that the signals are in phase in the\nfirst half of the time course, or that they gradually move in and out of phase\nin the second half. This can be explained by the fact that the signal is\ncontaminated with noise from all frequencies, which in turn corrupts the\nestimated instantaneous phase. \n\nContrast this with the results after band-pass filtering shown in  . Here all of the measures of PS\ncorrectly predict a value close to 1 in the first half of the signal, indicating\nthat all methods are picking up on the fact that the signals are in phase. In\nPanels (b)\u2013(d), which represents the WPS measures, the phase shift\noccurring after   t   = 170 leads to a decrease in phase\nsynchronization from this time point on. The toroidal-circular correlation\nappears to perform best, showing more sensitivity in detecting the episodes of\nphase synchronization compared to PLV and circular-circular correlation. It can\nalso be observed that the circular-circular correlation is more susceptible and\nsensitive to the noise than the other measures (see the increased wiggles in the\nestimates values). Interestingly, the PLV results appear to be more sensitive to\nthe window length used than the other two metrics. However, it is important to\nnote that none of the WPS methods are able to detect that the signals are in\nphase when the phase shift equals 2  \u03c0   and\n4  \u03c0  . \n\nIn contrast, both the phase coherence and CRP better captures the PS\nvariation than the WPS measures. This is partly due to the fact that using a\nsliding window deteriorates the resolution of the PS depending on the window\nsize. In particular, note how well CRP detects that the signal is in phase at\npoints when the phase shift equals 2  \u03c0   and\n4  \u03c0  . This is in contrast to phase coherence that\nerroneously assumes that signals are also in phase when the shifts are equal to\n  \u03c0   and 3  \u03c0  . The latter is due\nto the fact that phase coherence cannot differentiate between when the signals\nare in phase from when they are in anti-phase. The benefits of band-pass\nfiltering can be clearly seen in   and  , which show a reduction in bias\nwhen the data is properly filtered. \n\n and\n  in the\n  show the results of this simulation using the BEMD-based PS\nframework. Again, the results are consistent with those seen using band-pass\nfiltering, though the variance of the estimates are somewhat higher. \n\n\n### Simulation 3 \n  \n and   illustrate the results of Simulation 3 performed on\ndata before and after band-pass filtering. As illustrated in  , the two signals are designed to initially be\nin phase, after which they gradually go out of phase. At time   t  \n= 170 when the phase difference is 2  \u03c0  , the two signals\nwill be in anti-phase, before returning to being in phase at the end of the time\ncourse. \n\nThe costs of not band-pass filtering the data are again apparent in\n , as all of the methods show\nresults consistent with the null setting. This is in contrast to the results\nobtained after band-pass filtering shown in  . Here all measures of phase synchronization pick up on the fact\nthat the signals start out in phase, gradually goes out of phase (culminating at\ntime   t   = 170), before gradually return to being in phase.   and   show a reduction in\nbias when the data is properly filtered, except for PLV. \n\nIn Panels (b)\u2013(d), which represents the WPS measures, we see that\nusing a longer window length tends to capture phase dynamics better than using a\nsmaller window length. Again, the toroidal-circular correlation performs best,\nshowing increased sensitivity in detecting the episodes of phase synchronization\ncompared to circular-circular correlation and PLV. Increased window lengths\nprovide better results. Both phase coherence and CRP capture the manner in which\nphase synchonization varies more clearly than the WPS measures. In particular,\nCRP provides the most reliable measures in this simulation and clearly detects\nboth when the signals are in and out of phase. In comparison, phase coherence\ncannot separate when the signals are in phase and anti-phase, illustrating one\nof the shortcomings of the approach. \n\n and\n  in the\n  shows the results of this simulation using the BEMD-based\nPS framework. Again, the results are consistent with those seen using band-pass\nfiltering, though the variance of the estimates are somewhat higher. \n\n\n### Analysis of rs-fMRI data \n  \nAfter applying each method to the Kirby21 rs-fMRI data, two brain states\nwere extracted using k-means clustering.   contrasts the estimated brain states obtained using the different\nmethods for assessing phase synchonization, as well as with correlation-based\nsliding window analysis (both with and without pre-whitening). Brain states are\norganized into seven functional groups as described earlier in  . \n\nBeginning with the WPS methods, PLV (top row), circular-circular\ncorrelation (second row) and toroidal-circular correlation (third row) show\nroughly similar results with regards to the relationship between functional\ngroups in each brain state. However, the PLV derived brain states in general\ntake higher values than those obtained using toroidal-circular correlations,\nwhich in turn take higher values than those obtained using circular-circular\ncorrelations. These results are largely consistent with those seen in the\nsimulation studies, and the fact that toroidal-circular and circular-circular\ncorrelations take a wider range of values (compared to PLV which is constrained\nbetween 0 and 1). \n\nTurning to the IPS methods, the brain states obtained using phase\ncoherence (fourth row) tends to provide higher values in general compared to CRP\n(fifth row). This is not necessarily surprising as the range of potential values\nare different (phase coherence takes values between 0 and 1, while CRP takes\nvalues between \u22121 and 1). In addition, as seen in the simulation studies\nphase coherence has problems differentiating between when signals are in phase\nversus when they are in anti-phase. Together, this provide higher values in the\nestimated brain states. For example, State 2 shows a hyper-connected state where\nall PS measures are close to 1. \n\nInterestingly, the results obtained using sliding windows without any\nprewhitening (sixth row) is very similar to those obtained using the CRP. Across\nboth sessions and estimation methods, State 2 was characterized by stronger\ncorrelations (both positive and negative) relative to State 1. Moderate to\nstrong negative correlations between sensory systems (auditory, somatomotor, and\nvisual) components were present in State 2 but were reduced in State 1.\nSimilarly, negative correlations within the DMN (grey) components were present\nin State 2 and were reduced in State 1. This similarity between methods\nindicates that CRP may be finding similar brains states as CSW, but using more\nhigh-resolution data as it does not use a predefined window. These findings are\nlargely consistent with those of   who found that IPS and CSW conveyed comparable information of\ntime-resolved fMRI connectivity, though IPS provided finer temporal resolution.\nThe results obtained using sliding windows without prewhitening (seventh row)\nshow lower estimated values than the results without prewhitening, which is\nconsistent with results found in  . \n\nFinally, we found that both States 1 and 2 were highly reliable across\nsessions regardless of estimation method. The results for CRP and the sliding\nwindow approaches (described above) appear more interpretable than those\nobtained using the other methods. In particular the results for PLV and PC,\nwhich takes values between 0 and 1 appear to show extremely hyperconnected\nstates, perhaps reflective of the lower range of values that these measures\nreturn. \n\n in\nthe   shows the results for the analysis of the HCP dataset. Here\nafter applying each method to the rs-fMRI data, four brain states were extracted\nusing   k  -means clustering. Brain states are organized into the\nsame seven functional groups as before. The results show a great deal of\nsimilarity between the HCP and Kirby21 results with respect to the properties of\nthe estimated brain states obtained using each PS measure. Again, PLV derived\nbrain states (top row) take higher values than those obtained using\ntoroidal-circular correlations (third row), which in turn take higher values\nthan those obtained using circular-circular correlations (second row).\nSimilarly, the brain states obtained using phase coherence (fourth row) tend to\nprovide higher values compared to CRP (fifth row). Finally, the results obtained\nusing sliding windows without any prewhitening (sixth row) is very similar to\nthose obtained using the CRP. \n\nFocusing on the CRP results, States 1, 2 and 4 all show moderate to high\ncorrelations among signal components representing sensory systems (i.e., visual,\nsomatomotor, and auditory components). In States 1 and 4, a set of components in\nthe cerebellum showed negative correlations with sensory components. The HCP\nstates were largely similar to those obtained from the Kirby21 data, though it\nis important to note that the number and placement of the components in each HCP\nRSN do not map directly onto one another. \n\n\n\n## Discussion \n  \nThere is growing interest in measuring time-varying functional connectivity\nbetween time courses from different brain regions using rs-fMRI data. One such\napproach is to measure their phase synchronization across time. In this paper, we\nevaluate a number of methods for measuring PS and contrast them with one another. In\ndiscussing methods, we differentiate between two classes of methods: windowed phase\nsynchronization and instantaneous phase synchronization. \n\nWPS methods combine a static PS measure between two different signals with a\nsliding window to obtain a time-varying measure of PS. In principal, any metric that\nallows one to calculate an omnibus measure of PS can be used within this framework.\nSince phase information is circular data, the use of circular-circular correlation\nand toroidal-circular correlation were deemed natural candidate methods to use as a\nmeasure of PS. To the best of our knowledge, neither approach has previously been\nused to study PS in fMRI. The PLV in WPS method, has in contrast previously been\nused to assess episodes of elevated gastric-BOLD synchronization ( ). \n\nIPS methods directly use the phase difference time series obtained from\napplying the Hilbert transform, allowing one to compute an instantaneous measure of\nPS. This has the benefit of providing a higher temporal resolution, as there is no\nneed to choose an arbitrary window size as for the WPS methods. However, there\nremains a related somewhat arbitrary choice of filter bandwidth to narrow-band the\nsignals prior to analysis. Here we focused on two measures of IPS, phase coherence,\nwhich has already found wide usage in the field, and CRP, a newly developed\nmethod. \n\nThe three simulations illustrate several important points regarding the\nperformance of these methods. Simulation 1 shows that the WPS methods are highly\naffected by band-pass filtering. To illustrate,   shows that these methods tend to provide estimates that indicate that\nsignals are consistently in phase, even when the phases are designed to randomly\nvary. These results hold because the two signals being compared have a center\nfrequency of 0.05   Hz   after applying band-pass filter with cutoff\nfrequencies [0.03, 0.07]   Hz.   This leads to a situation where the\nsignals are constrained to remain relatively phase locked and thus have constant PS\nthroughout the time course. Importantly, the IPS results appear to perform similarly\non the data both before and after band-pass filtering (see   and  ), and\nthus appear to be less sensitive to filtering in the null setting. \n\nWhile at first glance, the results of Simulation 1 appear to indicate that\nband-pass filtering is not beneficial, and may in fact be detrimental, Simulations 2\nand 3 put this notion to rest. Here, the results performed on the non band-pass\nfiltered data indicate that none of the methods are able to pick up changes in real\nPS present in the data, and instead appear to erroneously indicate that the data\nbehave in manner consistent with null data. This is largely corrected after\nband-pass filtering the data (see   and\n ). This result holds both for WPS and IPS\nmethods, and indicates that band-pass filtering is a necessary step in the analysis\nof PS. \n\nThis result corresponds to theoretical findings (Bedrosian\u2019s theorem)\nthat suggest using band-pass filters in the study of PS is critical for the signal\nto have physically meaningful demodulation into its envelope and instantaneous phase\ncomponents. However, it is important to note that band-pass filtering comes at the\ncost of introducing further autocorrelation into the phase of the signal. In\naddition, band-pass filtering increases the risk of spurious detection of phase\nsynchronization ( ).\nWhile a band-pass filter denoises the signal, it can also lead to an increase in the\ndegree of synchronization by narrowing the band width; see  . \n\nThe results of Simulations 2 and 3 together show that all methods to a\ncertain extent were able to detect changes in PS. Focusing on the WPS measures,\ntoroidal-circular correlation performed best, showing increased sensitivity to\ndetecting episodes of PS compared to PLV and circular-circular correlation.\nCircular-circular correlation was the most susceptible and sensitive to noise. A\nprevious study comparing PLV and circular-circular correlation ( ) suggested that circular-circular\ncorrelation is appropriate for estimating the phase coupling reliably and not\nrestricted to bivariate analyses. It also indicated that using it as a measure of\nphase coupling could show slightly lower estimates than its counterpart. This result\nis consistent with what we found in our simulations. \n\nWhen assessing WPS measures, we also investigated a variety of window\nlengths. The simulations indicated that shorter windows yielded a higher estimate of\nphase synchronization and increased risk of detecting spurious PS. However, longer\nwindows made it harder to detect subtle changes. In general, longer window lengths\ntend to provide more accurate estimates of PS as they lead to a decrease in the\nvariation of the estimates. However, this may be only the case if the pairwise phase\ncoupling between the underlying signals is of semi-stationary nature with no abrupt\nchanges. \n\nIt is important to note that if overlapping windows are used, an\nautocorrelation (beyond that already present due to the smoothness of the BOLD\nsignal) is induced in the estimated WPS values, making changes in connectivity\nappear artificially smooth. Overlapping windows do provide a finer temporal\nresolution than non-overlapping windows, as the latter is a subset of the former.\nHowever, the exact gain in resolution is hard to quantify as it depends heavily on\nthe autocorrelation between windows. One of the goals of IPS is to gain a\ntime-resolved resolution. However, it is worth noting that the band-pass acts as an\nimplicit window due to Parseval\u2019s therorem. \n\nThe simulations clearly point to the benefits of band-pass filtering when\ncomputing PS. An alternative approach is to instead use empirical mode decomposition\nto extract frequencies of interest. This approach has been widely used to analyze\nEEG data, but also found recent use in application to fMRI data ( ;  ;  ).\nIn the   the results of the simulations described above were contrasted\nwith results obtained using an EMD-based PS framework. Both approaches yielded\nsimilar results for the different PS measures. However, the variance of the\nestimates obtained using EMD were somewhat higher for the same level of noise\ncompared to band-pass filtering. \n\nIPS measures consistently outperformed WPS measures in the simulations, and\nwere able to better pick up changes in PS across time. While phase coherence offers\nmore accurate and sensitive results than the WPS methods, it still discards\ninformation about the direction of the relationship. In contrast, CRP was not only\nable to detect phase synchronization but also preserve the directional information\ncontained in the relative phase difference of the signals. However, one should note\nthat the variation present in the IPS methods appears larger than WPS methods as\nevidenced by the wider confidence bounds. \n\nIt is interesting to consider the range of values each method returns. PLV\nand phase coherence take values between 0 and 1. In contrast, circular-circular\ncorrelation, toroidal-circular correlation, and CRP all take values between\n\u22121 and 1. This has to be taken into consideration when interpreting the\nresults of each method. For example, in Simulation 1 where we analyzed null data,\nthe latter methods returned values that lay symmetrically around 0. This makes it\neasier to interpret null results compared to PLV and phase coherence whose null\nvalues were around 0.35. Understanding what null values look like is a critical\ncomponent towards understanding the performance of a method, as it is otherwise\ndifficult to differentiate signal from noise. \n\nApplication to real rs-fMRI data showed results that were consistent with\nthe simulations. The WPS methods showed roughly equivalent results with respect to\nthe relationship between functional groups in each estimated brain state. As\ndescribed above, the shorter range of values for PLV and phase coherence made it\nmore difficult to pick up subtle differences between brain states, and they both\nreturned a hyper-connected brain state where all PS measures are close to 1.\nInterestingly, the brain states estimated using CRP closely resembled those\nestimated using sliding window correlations. Thus, it appears that CRP is finding\nsimilar brains states but using more high-resolution data as it does not require the\nuse of a sliding window. Finally, there was a large degree of similarity between\nstates estimated from the Kirby21 and HCP datasets, even though they differ in\nimportant aspects including repetition time, scan length, and sample size. \n\nThe focus of this work is on showing the potential of the PS framework and\nhighlighting the necessity of using appropriate PS measures to estimate time-varying\nfunctional connectivity. However, we believe the approach can be extended to allow\nfor the analysis of directed connectivity between regions of interest. For example,\nthis could be studied using instantaneous phase time series from fMRI data in\nconjunction with transfer entropy (phase-based transfer entropy) ( ). \n\nIn summary, we recommend the use of CRP as a measure of PS as it is able to\nseparate when the signals are in phase from when they are in anti-phase. In\naddition, it returns a range of values similar to correlation, which makes it\npossible to interpret results similarly. Of all the methods tested, it showed the\ngreatest concurrence with CSW, with the benefit of not having to predefine a window\nlength. \n\n\n## Supplementary Material \n  \n \n", "metadata": {"pmcid": 8011682, "text_md5": "10d6c93d1a2e1067106bd1880af53d88", "field_positions": {"authors": [0, 55], "journal": [56, 66], "publication_year": [68, 72], "title": [83, 170], "keywords": [184, 350], "abstract": [363, 1981], "body": [1990, 54690]}, "batch": 1, "pmid": 33385554, "doi": "10.1016/j.neuroimage.2020.117704", "pmc_url": "https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8011682", "efetch_url": "https://eutils.ncbi.nlm.nih.gov/entrez/eutils/efetch.fcgi?db=pmc&id=8011682"}, "display_title": "pmcid: <a href=\"https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8011682\">8011682</a>", "list_title": "PMC8011682  Evaluating phase synchronization methods in fMRI: A comparison study\nand new approaches"}
