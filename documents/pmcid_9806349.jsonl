{"text": "Zhang, Xiangfei and Shams, Shayel Parvez and Yu, Hang and Wang, Zhengxia and Zhang, Qingchen\nFront Neurosci, 2022\n\n# Title\n\nA pairwise functional connectivity similarity measure method based on few-shot learning for early MCI detection\n\n# Keywords\n\nAlzheimer's disease\nfew-shot learning\nautomatic diagnosis\nsmart medical\nrs-fMRI\n\n\n# Abstract\n \nAlzheimer's disease is an irreversible neurological disease, therefore prompt diagnosis during its early stage, i.e., early mild cognitive impairment (MCI), is crucial for effective treatment. In this paper, we propose an automatic diagnosis method, a few-shot learning-based pairwise functional connectivity (FC) similarity measure method, to detect early MCI. We first employ a sliding window strategy to generate a dynamic functional connectivity network (FCN) using each subject's rs-fMRI data. Then, normal controls (NCs) and early MCI patients are distinguished by measuring the similarity between the dynamic FC series of corresponding brain regions of interest (ROIs) pairs in different subjects. However, previous studies have shown that FC patterns in different ROI-pairs contribute differently to disease classification. To enable the FCs of different ROI-pairs to make corresponding contributions to disease classification, we adopt a self-attention mechanism to weight the FC features. We evaluated the suggested strategy using rs-fMRI data obtained from the Alzheimer's Disease Neuroimaging Initiative (ADNI) database, and the results point to the viability of our approach for detecting MCI at an early stage. \n \n\n# Body\n \n## 1. Introduction \n  \nRecently, artificial intelligence has achieved exciting achievements in many fields (Zhou et al.,  ; Yu et al.,  , ; Wang S. et al.,  ). Benefiting from the progress of deep learning technology, computer-aided medical tools for neurological diseases have been developed and applied in a wide range of fields (Wang et al.,  ; Li et al.,  ; Zhao et al.,  ). In terms of disease diagnosis, researchers have developed various auxiliary diagnostic tools (Li et al.,  ; Zhao et al.,  , ). For neurological diseases, however, although deep learning has become a promising method to diagnose neurological diseases, it is a serious challenge to learn potential features from real data using deep learning to diagnose neurological diseases, such as autism spectrum disorder and Alzheimer's disease (AD). \n\nAs the most common type of dementias in old age, AD is a neurological disorder that cannot be reversed. It's clinically characterized by gradual and progressive decline in memory as well as other cognitive functions, which increases the potential safety risks and even threatens life. Since AD cannot be cured to reverse its progression, early diagnosis is essential to delay AD progression and reduce potential risk at its initial prodromal stage, i.e., mild cognitive impairment (MCI), especially at early MCI (eMCI) stage (Kam et al.,  ). AD involves the disorder of brain structures and functions while the brain function of eMCI patients is expected to be greatly affected. Therefore, many eMCI studies focus on exploring its functional biomarkers for detecting eMCI (Chen et al.,  ; Kam et al.,  ; Wang et al.,  ). \n\nResting state functional magnetic resonance imaging (rs-fMRI), as an emerging noninvasive neuroimaging technology, utilizes blood oxygen level-dependent (BOLD) signals to measure spontaneous brain functional activities. Recently, many researchers have worked incredibly hard in detecting the potential diagnostic biomarkers of eMCI/AD based on rs-fMRI data. In the area of computer-aided diagnosis, machine learning has become one of the most important methods to effectively analyze rs-fMRI data for eMCI detection, which is beneficial to effectively comprehend the neurological basis of eMCI (Kam et al.,  ; Zhao et al.,  ). \n\nSince the human brain is particularly interconnected and well-organized system, the process of high-level cognition relying on the interactions among distributed brain regions of interest (ROIs). To quantify functional interactions between ROIs, the rs-fMRI data has been employed to the generate functional connectivity network (FCN) that the rich information exchange among ROIs (Wang et al.,  ). Functional connectivity (FC) analysis quantifies the temporal correlations of BOLD signals across spatially distant ROIs. According to an increase in the number of rs-fMRI reports that have concentrated on this research, many brain disorders including AD are typically accompanied with changes in the FC patterns. As a result, the analysis of FCN offers a chance to investigate the connections between ROIs, which is necessary to find promising biomarkers for AD diagnosis. \n\nBoth conventional machine learning methods such as support vector machine and deep learning methods such as recurrent neural network have been widely used in FC analysis in previous rs-fMRI researches (Kam et al.,  ; Wang et al.,  ; Zhao et al.,  ). For instance, Wang et al. ( ) suggested using a spatial-temporal convolutional-recurrent neural network to extract FC features for AD progression prediction. Zhao et al. ( ) constructed a multi-view higher-order FCN and extracted features from it for support vector machine classification. Most studies have found that FCs based on different ROI-pairs have inconsistent effects on model outcomes (Dai et al.,  ; Kam et al.,  ; Wang et al.,  ; Zhao et al.,  ). Some FCs have made positive contributions to the model results to varying degrees, while some FCs played a negative role in the model outputs. In other words, among many FCN models, some FC features are unnecessary. Therefore, it is necessary to filter the features to eliminate redundant features or weaken the negative effects of irrelevant features on the model outputs. Generally, classical machine learning methods usually adopt statistical algorithms (e.g.,   t  -test) to remove features weakly associated with diseases, while deep learning methods automatically learn multiple different disease-related feature abstractions from the input data. \n\nTo this end, a novel pairwise FC similarity measure method based on few-shot learning and self-attention mechanism is proposed in this paper for eMCI detection. Our motivations are that (1) since different FC features may have different contributions to the model results, we employ the self-attention mechanism to weight FC features, so that FC feature can obtain an appropriate weight to properly affect the model outcomes; (2) Recently, metric learning is popular in classification tasks and has achieved satisfactory results (Jiang et al.,  ; Lai et al.,  ; Wang Y. et al.,  ). Therefore, we suggest that use metric learning to measure the similarity between pairwise FCs for eMCI vs. NC classification is feasible.   illustrates the diagrammatic representation of the proposed framework, which consists of four parts, i.e., (1) construction of dynamic FCN, (2) simplified dynamic FCN, (3) calculation similarity unit, and (4) Siamese network framework. Specifically, we initially utilize the sliding-window approach (Wang et al.,  ; Zhao et al.,  , ) to construct a dynamic FCN, as recent progresses have consistently demonstrated that there is abundant diagnostic information on the inter-individual variability of FCN. Furthermore, due to the symmetric nature of the FCN matrix, only the lower off-diagonal triangular part of the FCN matrix are retained to avoid redundant computation. Further, the FC series are weighted by a self-attention mechanism, and the overall similarity between subjects is achieved by figuring out the similarity of its pairwise weighted FC time series. Finally, a popular metric learning/few-shot learning method, i.e., Siamese network, is trained to measure the similarity between subjects. \n  \nThe framework of the proposed model.   (A)   Construction of dynamic FCN.   (B)   Simplified FCN matrix.   (C)   Calculation similarity unit.   (D)   Siamese network framework. \n  \nThe major advantages of this study are three folds: \n  \n Firstly  , the self-attention mechanism is used to automatically assign weights to FC features. \n  \n Secondly  , the proposed model combines a self-attention mechanism and a few-shot learning strategy to facilitate feature learning and improves classification performance. \n  \n Thirdly  , systematic experiments are conducted on the large-scale ADNI dataset. The outcomes illustrate that the proposed method outperformed current cutting-edge classification techniques. \n  \n\n## 2. Materials and methods \n  \nThe proposed model aims to detect whether subjects suffer from eMCI. To fulfill this purpose, we develop a pairwise FC similarity measure model, which consists of dynamic FCN, pairwise FC similarity measure module and Siamese network, as shown in  . Furthermore, experiments are carried out on the data from Alzheimer's Disease Neuroimaging Initiative (ADNI) database to verify the effectiveness of the proposed model. \n\n### 2.1. Materials \n  \n1) Data acquisition: The ADNI database has been used to obtain the rs-fMRI data employed in this investigation. A total of 464 unprocessed rs-fMRI data from 95 MCI patients and 48 normal controls (NCs) were used. \n\nThis study's participants have been scanned with one or several appointments divided mostly by minimum of half a year, which is significant since using these 464 scans divided into 154 NC cases and 310 MCI cases (165 eMCI and 145 late MCI cases, correspondingly) as a result. Since we only used eMCI data and excluded late MCI data and ultimately used 319 scan cases (154 and 165 for NCs and eMCIs, correspondingly). The scanning period for each subject is 7 min, and the in-plane imaging resolution for each scan is 2.29\u20133.31 mm, slice thickness is 3.31 mm, TE (echo time) is 30 ms, and TR (repetition time) is 2.2\u20133.1 s. (resulting in 140 volumes).   provides a summary of the 319 subject's demographic data; values are expressed as the overall average variance. Male/Female: M/F. \n  \nDemographic information of the studied subjects. \n  \n2) Data pre-processing: Using the FSL FEAT software, the rs-fMRI scans for each person under study were pre-processed according to a set manner. We mainly processed the remaining 137 volumes using a conventional pipeline, which included slice timing correction, head motion estimation, bandpass filtering, and regression of nuisance variables after initially discarding the initial three volumes during pre-processing for magnetization equilibrium (i.e., white matter, cerebrospinal fluid, and motion parameters). Subjects exhibiting head motions more than 2.0 mm in translation or 2.0 in rotation were disqualified. Along with that, we used T1-weighted MRI to accomplish structural skull stripping, and we aligned the skull-stripped fMRIs with the Montreal Neurological Institute (MNI) space. After that, a Gaussian kernel with a full-widthat-half-maximum (FWHM) of 6 mm was used to further spatially smooth the fMRI data. Because doing so might result in more artifacts, we didn't undertake scrubbing on data with frame-wise displacements >0.5 mm. The patients with a frame-wise displacement of more than 2.5 min (  FD  >0.5) were disqualified from further study. At last, using the AAL atlas, we retrieved the mean rs-fMRI time series (bandpass filtered from 0.015 to 0.15 Hz) from a collection of 116 pre-defined ROIs. Finally, the suggested method's input data consisted of time series of BOLD signals from all ROIs. \n\n\n### 2.2. Dynamic FCN \n  \nLetting   denote the rs-fMRI scanning series data of a subject, each vector   contains the BOLD measurements of the   n  -th ROI at   M   sequential time points. To construct the dynamic FCN, the rs-fMRI scanning series is split into several overlapping subsegments by a sliding window with fixed length, and furthermore a short-term FCN is constructed for each subsegment. All the short-term FCNs compose the dynamic FCN for a subject. The workflow of constructing a dynamic FCN is shown in  . \n\nIn detail, the rs-fMRI scanning series are partitioned into   K   = \u230a  M  \u2212  w  \u230b/  s  +1 overlapping subsegments, where   w   and   s   are the length and the step size of the sliding window, respectively.   k  -th (1 \u2264   k   \u2264   K  ) window, the short-term FC between the   i  -th and the   j  -th ROIs is calculated by the Pearson's correlation coefficient: \n\nwhere   x  (  k  ) denotes the sub-series in the   k  -th segment of   i  -th ROI. Thus, the shot-term FCN can be constructed as  , and accordingly the dynamic FCN can be represented as   D   = [  D  (1), \u22ef\u2009,   D  (  k  ), \u22ef\u2009,   D  (  K  )]\u2208\u211d . For two specific ROIs, the FC series   FC   = (  FC  (1), \u22ef\u2009,   FC  (  k  ), \u22ef\u2009,   FC  (  K  )) reflects the dynamic FC between   i  -th and   j  -th ROIs. \n\nSince each FCN matrix   D  (  k  ) is symmetry, only the lower off-diagonal triangular part is used, i.e.,   (as shown in  ), so that redundant computation can be avoided to improve the training efficiency. \n\n\n### 2.3. Pairwise FC similarity measure \n  \nThe similarity of FC series between different subjects can serve as a feature to distinguish subject categories. Intuitively, the FC time series of ROI pairs between subjects from the same category should be more similar, while the FC series similarity between subjects from different categories should be lower. Therefore, a pairwise FC similarity measure between different subjects can be used to discriminate between NC and eMCI. \n\nHowever, according to previous studies (Wang et al.,  ; Zhao et al.,  ), FC between different ROI pairs has a distinct contribution degree to eMCI diagnosis. To this end, we assign a weight to each element of the FCN matrix with a self-attention mechanism as follows: \n\nwhere   Query   conveys the query, meaning that for each FC series is a enquiry to be asked,   Key   conveys the key which each query compares,   Value   conveys the value which extracts out the most important information from each FC series, and   W  ,   W  ,   W   are learnable parameters. The weighted dynamic FCN matrix   is calculated using Equation (3): \n\nwhere   d   denotes the dimension of   Key  . In our case,   D   and   are the same scale. \n\nAfter the self-attention mechanism,   is used to calculate the pairwise FC series similarity of the subjects. As shown in  , the similarity between the FC series of the corresponding ROIs between the two subjects is calculated and summed as the similarity between two subjects. Especially, the similarity is calculated by cosine similarity: \n\nwhere   in   denotes the weighted FC series between   i  -th and   j  -th ROIs of   p  -th subject. Due to dynamic FCN is inherently time sensitive, that is, if the chronological order of the subnetworks of dynamic FCN changes, the dynamic FCN will also change (Chen et al.,  ; Zhao et al.,  ). Therefore, ensuring the phase matching among the subnetworks of the subjects' dynamic FCNs is the key to achieve temporal consistency comparison. In Equation 4, since the element-wise computation for cosine similarity,   is invariant to the order of elements in   and  . Therefore, the phases of the subnetworks among subjects are matched, so that the meaningful comparisons can be made among subjects on temporal consistency. \n\n\n### 2.4. Few-shot learning training strategy \n  \n1) Siamese network: In this study, we use the Siamese network as a concrete implementation of few-shot learning. The Siamese network consists of two subnetworks that share parameters, and in our model, the subnetworks consist of selfattention module. As illustrated in  . \n\n2) Dataset partitioning: The dataset used in this paper is divided into three parts, including training set, validation set and test set. The training set is used to learn the model parameters by optimizing the objective function. The training set and test set are further divided into support set and query set, respectively. \n\n3) Objective function: In this work, the   ContrastiveLoss   (Hadsell et al.,  ) is employed as the objective function: \n\nwhere   s   is the cosine similarity value, margin is the hyperparameters, and   y   is the label of a subject pair, if two subjects from same category,   y   = 1, otherwise,   y   = 0. When   y   = 1, a smaller loss denotes the similarity between subjects is bigger, while when   y   = 0, a smaller loss means that the similarity between subjects is smaller. Therefore, training the parameters aims to miminize the objective function. We use the backpropagation algorithm to train the parameters. \n\n\n\n## 3. Results \n  \n### 3.1. Comparison methods \n  \nIn the experiments, we compare the proposed method with the following three methods: \n  \n Support vector machine (SVM):   In this method, the average value of dynamic FC series is regarded as the features of ROI pairs. Therefore, for each subject, the size of the feature vector input into SVM is  . In our case,   N   = 116. \n  \n Random forest (RF):   In this method, the input features are the same as those fed into the SVM. \n  \n Long short term memory (LSTM):   In this method, the input features are dynamic FCN matrices. Since LSTM is advantageous for processing sequence data, it is used to extract features from FC series. Finally, a   softmax   function is used for classification, and the objective function uses the   Crossentropy   Loss  . \n  \n\n### 3.2. Experimental settings \n  \nIn this study, the parameters of the sliding window are set as   w   = 30,   s   = 2, that is, the length of the sliding window is 30 time points or 90 s and the size of each transition is 2 time points or 6 s. In this paper, we report the 2-way (i.e., NC vs. eMCI) 5-shot evaluation results. \n\nTo verify the effectiveness of the proposed method and the comparison methods, four criteria, i.e., classification accuracy (ACC), specificity (SPE), positive predictive value (PPV) and negative predictive value (NPV), are used. \n\nwhere TP, TN, FP, and FN represent True Positive, True Negative, False Positive, and False Negative, respectively. \n\n\n### 3.3. Classification performance \n  \nThe classification results of 5-shot in NC vs. eMCI are shown in  . As   demonstrates that our method achieves 78% ACC value, 80% SPE value and so on. Obviously, the proposed method generally achieved better performance than the comparison methods. For example, in terms of ACC, the proposed method outperforms the best comparison method (i.e., LSTM) by 6.33%; and in terms of PPV value, the proposed method achieved the improvement of 11.60%, compared to the most effective comparison method (i.e., LSTM). These results show that explicit modeling of the pair-wised FC similarity measure in rs-fMRI time series comparing various subjects to capture eMCI-related ROIs in brain FC is helpful in predicting the AD progression. \n  \nPerformances of the proposed method and the comparison methods. \n  \n\n\n## 4. Discussion \n  \n### 4.1. Pairwised FC similarity \n  \nTo discover abnormal patterns of dynamic FC in eMCI patients,   presents four groups (i.e., NC query set and NC support set, NC query set and eMCI support set, eMCI query set and NC support set, and eMCI query set and eMCI support set) average similarity. \n  \nAverage similarity matrix between query subjects and support subjects.   (A)   NC query subjects and NC support subjects.   (B)   NC query subjects and eMCI support subjects.   (C)   eMCI query subjects and NC support subjects.   (D)   eMCI query subjects and eMCI support subjects. \n  \nFrom  , we can draw several fascinating observations.   First  , the cosine similarity values of the query set and the support set are mostly positive, probably because the dynamic FC of eMCI patients did not change significantly.   Second  , more negative cosine similarities appear when the query set and support set are from different categories, which is in line with our expectations. When more negative similarity values appear, it means that their sum will be smaller, which is in line with our goal of less similarity between subjects from different classes.   Finally  , the four heatmaps show overall similarities and local differences. This is because the abnormal FC pattern in eMCI patients occurs between a few ROIs, not the whole brain FC pattern changes. \n\n\n### 4.2. Discriminative pairwised ROIs \n  \nTo find the most discriminative ROI pairs, we compared the difference in mean similarity values between different queries on the same support set. Specifically, we compared the differences in similarity between two different query sets and support sets when NC subjects and eMCI subjects were used as support sets, respectively, with the aim of discovering the FCs that were different between eMCI query subjects and NC query subjects. Under the same support set, the ROI pairs with greater similarity difference are considered as the most discriminative pairwised ROIs, and the top ten most discriminative ROI pairs are shown in the  . \n  \nTop 10 pairwised ROIs identified by the proposed method. \n  \nFrom  , we can see that the discriminative FCs and brain ROIs are extended out over both hemispheres which is a common distribution in previous studies (Wee et al.,  ; Zhao et al.,  ), demonstrating the pattern of functional impairments that is dispersed throughout the whole brains of eMCI patients. Several brain ROIs,   right superior frontal gyrus   (SFGmed.R),   left rectus gyrus   (REC.L), and   right anterior cingulate gyrus   (ACG.R), belong to the default mode network (DMN), according to previous studies (Xia et al.,  ; Suk et al.,  ). DMN, which are selected as the ROI in eMCI identification that are the most discriminative and show a strong connection with the ROI in the higher-level cognitive functional networks (Seeley et al.,  ). Several brain ROIs, CRBL3.L, CRBL10.L, and CRBL10.R, belong to cerebellum regions. Researches has shown that patients with MCI experienced structural degenerative changes in some cerebellum regions (Wee et al.,  ) and disruption of cerebellum functions (Wee et al.,  ). The functions of   left angular gyri   (ANG.L) are maintaining attention, manipulating controls, working memory, making decisions, among many of others (Michael,  ; Etienne and Christopher,  ), and this region has been closely related to eMCI in previous reports (Liang et al.,  ; Zhou et al.,  ). The brain ROIs identified by uor method are consistent with previous reports, indicating the effectiveness of our proposed method. \n\n\n\n## 5. Conclusions \n  \nIn summary, a pairwise FC similarity measure method based on few-shot learning is proposed in this work for eMCI detection. The unique property of this method is combination of a self-attention mechanism to automatically learn the weights of FC features, which is beneficial for disease classification using whole-brain ROIs. This idea offers an encouraging solution to identify and categorize brain FCNs, and can also be expanded to FC-based diagnostic research in other brain diseases. \n\nIn this research, we focus on the automatic identification of eMCI using only rs-fMRI data. Indeed, it is possible to diagnose eMCI with the help of different imaging modalities, such as structural MRI and fluorodeoxyglucose PET. It is also intriguing to use multimodal Data for eMCI detection, which will be the focus of our upcoming work. In addition, the dataset is still insufficient even though we use all rs-fMRI scans from all individuals of ADNI database. In further research, we'll assess the proposed methods using a large-scale dataset with more brain neurological disease like autism spectrum disorder. \n\n\n## Data availability statement \n  \nPublicly available datasets were analyzed in this study. This data can be found at:  . \n\n\n## Author contributions \n  \nXZ: formal analysis, investigation, methodology, and writing-original draft. SS and HY: review and editing. ZW: data curation and funding acquisition. QZ: funding acquisition, project administration, and conceptualization. All authors contributed to the article and approved the submitted version. \n\n \n", "metadata": {"pmcid": 9806349, "text_md5": "44fdbdb47efe9dc84be0e69248c03fea", "field_positions": {"authors": [0, 92], "journal": [93, 107], "publication_year": [109, 113], "title": [124, 235], "keywords": [249, 329], "abstract": [342, 1571], "body": [1580, 24027]}, "batch": 1, "pmid": 36601596, "doi": "10.3389/fnins.2022.1081788", "pmc_url": "https://www.ncbi.nlm.nih.gov/pmc/articles/PMC9806349", "efetch_url": "https://eutils.ncbi.nlm.nih.gov/entrez/eutils/efetch.fcgi?db=pmc&id=9806349"}, "display_title": "pmcid: <a href=\"https://www.ncbi.nlm.nih.gov/pmc/articles/PMC9806349\">9806349</a>", "list_title": "PMC9806349  A pairwise functional connectivity similarity measure method based on few-shot learning for early MCI detection"}
