{"text": "McAvoy, Mark P. and Liu, Lei and Zhou, Ruiwen and Philip, Benjamin A.\nbioRxiv, 2024\n\n# Title\n\nReducing individual differences in task fMRI with OGRE (One-step General Registration and Extraction) preprocessing\n\n# Keywords\n\nimage analysis pipeline\nfMRI\nbrain\nsoftware\nmagnetic resonance imaging\nhumans\nbrain mapping\n\n\n# Abstract\n \nVolumetric analysis methods continue to enjoy great popularity in the analysis of task-related functional MRI (fMRI) data. Among these methods, the software package FSL (FMRIB, Oxford, UK) is omnipresent throughout the field. However, it remains unknown what advantages might be gained by integrating FSL with alternative preprocessing tools. Here we developed the One-step General Registration and Extraction (OGRE) pipeline to apply FreeSurfer brain extraction for simultaneous registration and motion correction (\u201cone-step resampling\u201d), for FSL volumetric analysis of fMRI data. We compared three preprocessing approaches (OGRE, FSL, and fMRIPrep) in a dataset wherein adult human volunteers (N=39) performed a precision drawing task during fMRI scanning. The three approaches produced grossly similar results, but OGRE\u2019s preprocessing led to lower inter-individual variability across the brain and greater detected activation in primary motor cortex contralateral to movement. This demonstrates that FreeSurfer tools and one-step resampling can improve FSL\u2019s volumetric analysis of fMRI data. The OGRE pipeline provides an off-the-shelf method to apply FreeSurfer-based brain extraction and one-step resampling of motion correction and registration for FSL analysis of task fMRI data. \n \n\n# Body\n \n## INTRODUCTION \n  \nNumerous methods and software packages exist for the analysis of fMRI data, and many of these approaches offer different advantages and tradeoffs. One commonly used analysis package is the fMRIB Software Library (FSL;  ), particularly its FEAT software for general linear model (GLM) volumetric model-based analysis of fMRI data ( ;  ). FSL is highly popular: as of June 2024, the reference for FSL\u2019s Brain Extraction Tool (BET;  ) has over 12000 citations, including over 1000 in the preceding eighteen months ( ). However, despite FSL\u2019s popularity, FSL preprocessing has some shortcomings, one of which is its reliance on BET for identifying brain voxels in the scan volume. BET is prone to under- and over-extraction of brain voxels ( ;  ;  ), and has limited options for adjusting its algorithmic criteria ( ). Together these shortcomings mean that BET either produces suboptimal brain extractions or requires time-consuming and error-prone manual adjustment ( ;  ). Therefore, alternative FSL-compatible preprocessing approaches (including brain extraction) could improve the reliability and accuracy of fMRI data analysis. \n\nOne alternative preprocessing approach takes advantage of the FreeSurfer parcellation (e.g.  ;  ;  ) to refine the brain extraction and improve the alignment, registration, and motion correction of functional data by means of a novel \u201cone-step resampling\u201d procedure with FSL tools ( ). This process removes spatial artifacts and distortions, creates cortical surface and myelin maps, performs precise within-individual cross-modal registrations, and carries out volume-based registrations to standard spaces. The one-step resampling procedure is a small portion of the full Human Connectome Project (HCP) processing pipeline, which subsequently uses a surface-based approach with numerous further advantages ( ;  ;  ;  ). However, volumetric approaches continue to enjoy widespread popularity as lower resolution fMRI data remains common in the field (e.g.  ;  ), and volumetric approaches require less computing infrastructure than surface-based analysis. Few studies have assessed the potential advantages gained by incorporating the one-step resampling procedure into FSL volumetric analysis, because direct, controlled tests (i.e. controlling for later processing steps) have not been possible because the existing standard in FreeSurfer-based preprocessing, fMRIprep ( ), neither provides off-the-shelf appliation to FSL FEAT ( ) nor includes the one-step resampling procedure. \n\nHere, we created the OGRE (One-step General Registration and Extraction) pipeline to integrate the \u201cone-step resampling\u201d procedure as a general-purpose fMRI preprocessing tool for FSL volumetric analysis. We performed a fully-controlled comparison of three preprocessing pipelines: OGRE vs. fMRIprep vs. FSL preprocessing, by evaluating the effects of the three preprocessing pipelines on a fMRI motor task with the same subsequent volumetric FSL FEAT GLM analysis. The three preprocessing methods were compared for differences in task-based activation, brain extraction, and inter-individual variability. \n\n\n## MATERIALS & METHODS \n  \n### Participants \n  \nThirty-seven right-handed adults (28 female; ages 48 \u00b1 18, range 24\u201382) performed a precision drawing task (see   below) in the fMRI scanner. 12/37 participants had peripheral nerve injuries to their right arm, but the differences between groups (categorical or performance-related) were not a focus of the current study. All participants gave informed consent, and all procedures were approved by the Institutional Review Board at Washington University in St. Louis School of Medicine. \n\n\n### fMRI Acquisitions \n  \nScans were performed on a Siemens PRISMA 3T MRI scanner. BOLD EPIs for fMRI were collected using a T2*-weighted gradient echo sequence, a standard 64-channel birdcage radio-frequency coil, and the following parameters: TR = 662 ms, TE = 30 ms, flip angle = 52\u00b0, 72 \u00d7 72 voxel matrix, FOV = 216 mm, 60 contiguous axial slices acquired in interleaved order, resolution: 3.0 \u00d7 3.0 \u00d7 3.0 mm, bandwidth = 2670 Hz/pixel, multi-band acceleration = 6x. Siemens auto-align was run at the start of each session. \n\nHigh-resolution T1-weighted structural images were also acquired, using the 3D MP-RAGE pulse sequence: TR = 4500 ms, TE = 3.16 ms, TI = 1000 ms, flip angle = 8.0\u00b0, 256 \u00d7 256 voxel matrix, FOV = 256 mm, 176 contiguous axial slices, resolution: 1.0 \u00d7 1.0 \u00d7 1.0 mm. A T2-weighted image was also acquired at: TR = 3000 ms, TE = 409 ms, 256 \u00d7 256 voxel matrix, FOV = 256 mm, 176 contiguous axial slices, resolution: 1.0 \u00d7 1.0 \u00d7 1.0 mm. Spin echo field maps were also collected before the functional runs. \n\n\n### fMRI Task \n  \nEach participant completed 3 BOLD functional scans. During each scan, the participant used their right hand to perform a precision drawing task based on the STEGA app ( ;  ). (These runs were interleaved with 3 additional runs where the participants used their left hand to perform the same task, but these left hand runs are not included in the current study.) also used their left hand Participants saw hollow shapes, and were instructed to draw a line within the bounds of the shape, as fast as possible while prioritizing staying in-bounds over speed. Participants saw a video overlay of their (transparent) hand/pen over the drawn shape, using an MRI-compatible drawing tablet with bluescreen technology ( ), as shown in  . The task was presented in a block design with 15.2 seconds (23 images) of drawing, followed by 15.2 seconds (23 images) of rest (fixation cross). A scan comprised ten cycles of draw/rest, with an additional rest block at the start, and 3.3 seconds (5 images) of additional rest after the final rest block, leading to a total duration of 5:23 (230 images of drawing, 258 rest) per scan. \n\n\n### Data Preprocessing: One-step General Registration and Extraction (OGRE) Pipeline \n  \nOGRE (One-step General Registration and Extraction) was developed on Macintosh (Apple, Cupertino CA) and is based on version 3.27 of the HCP pipeline ( ). Preprocessing steps include FreeSurfer parcellation and brain extraction, motion correction, field map distortion correction, and warping to the 2mm MNI atlas via the \u201cone-step resampling\u201d via FSL FLIRT and FNIRT ( ) as detailed in  . New features added for OGRE included the option to specify native resolution as 0.7, 0.8, or 1.0 mm; the option to leave fMRI time series in native HCP space instead of registering to MNI atlas; extended compatibility to FreeSurfer versions 7.2.0, 7.3.2, 7.4.0 and 7.4.1 ( ); adjustable dilation/erosion settings for brain masks; and the addition of three new steps to match FEAT: optional nonlinear spatial filtering ( ), optional nonlinear temporal high pass filtering ( ), and a switch from mean-based to median-based intensity normalization. OGRE also produces FEAT-formatted registration images and matrices for higher-level FEAT analysis. OGRE preprocessing outputs were entered as data for analysis in FEAT using its \u201cStatistics\u201d option (rather than \u201cFull Analysis,\u201d since OGRE has replaced FEAT preprocessing). \n\nOGRE software and documentation are available online at:  \n\n#### Parallel analyses: OGRE vs. fMRIprep vs. FSL-only. \n  \nIn the \u201cOGRE analysis,\u201d the OGRE pipeline described above was used to preprocess data with the following options: FreeSurfer 7.4.1, native resolution of 1 mm, distortion correction using spin echo field maps, spatial smoothing kernel of 6 mm FWHM, intensity normalization via \u201cgrand median scaling\u201d to a value of 10000, high pass temporal filtering with 60 sec cutoff, and output registration to 2 mm MNI atlas. Subsequently, GLM statistical analysis was performed with FEAT version 6.0.7 ( ). Explanatory variables (EVs) were modeled, along with their temporal derivatives, according to the block design described in the previous section ( ), with additional confound EVs based on head motion parameters (translation and rotation). Volumes with excess head motion were addressed ( ) via additional confound EVs calculated within each time series as framewise displacement of 75  percentile + 1.5* interquartile range, using the FSL script FSLMotionOutliers. The hemodynamic response was accounted for by convolving the model with a double-gamma function. First-level contrasts of parameter estimates (COPEs) were calculated for Task vs. Rest. The first-level COPE (Task > Rest) served as input to higher-level analyses performed using a fixed-effects model. Z-statistic (Gaussianized T) images were thresholded using clusters determined by Z \u2265 3.1 and a corrected cluster significance threshold of p < 0.05. The first-level COPEs were averaged across runs for each participant (second level). Region of interest (ROI) analyses were performed on second-level (i.e. participant-level) data, as detailed in   ROI Analyses   below. \n\nIn the \u201cfMRIprep analysis,\u201d preprocessing was performed using fMRIprep 23.2.3 ( ), using default settings except that slice timing was ignored, sub-millimeter reconstruction option was disabled, and outputs were registered to 2mm MNI atlas. Full fMRIprep methods are described in  . FSL was used to perform spatial smoothing with a 6 mm FWHM and high pass temporal filtering with 60 sec cutoff, and registration outputs were modified following established workarounds for integrating fMRIprep output with FSL ( ). Subsequently, GLM statistical analysis was performed with FEAT as described for the OGRE analysis above. \n\nIn the \u201cFSL-only analysis,\u201d preprocessing included the following steps: Non-brain structures were removed using BET. Head movement was reduced using MCFLIRT motion correction. Distortion correction was applied using spin echo field maps using FSL PRELUDE and FUGUE. Paralleling the OGRE implementation, spatial smoothing, intensity normalization, and the high-pass temporal filter were applied with the same settings as above. Functional data were registered with the high-resolution structural image using boundary-based registration ( ), and resampled to 2\u00d72\u00d72 mm resolution using FLIRT; the participant images were then registered to standard images (Montreal Neurological Institute MNI-152) using FNIRT nonlinear registration ( ). Subsequently, GLM statistical analysis was performed with FEAT as described for the OGRE analysis above. \n\n\n#### ROI Analyses. \n  \nTo quantitatively compare the three analyses, a region-of-interest (ROI) approach was used, using an atlas of 300 volumetric ROIs with known network assignments ( ). This atlas assigned each area to one of 14 networks (auditory, cingulo-opercular, default mode, dorsal attention, frontoparietal, medial temporal, parietomedial, reward, salience, somatomotor dorsal, somatomotor lateral, ventral attention, and unassigned). For each participant, the signal magnitude was calculated as the mean % BOLD signal change for the Task > Rest contrast in second-level (within participant) analyses. \n\nThe three analyses were compared via two approaches. The first approach focused on inter-individual variability. The primary variable was the standard deviation (across the signal magnitudes of the 39 participants, within each ROI). Direct statistical comparisons within each ROI used a pairwise Pitman-Morgan test ( ) to compare the inter-individual variability of OGRE signal magnitudes vs. the inter-individual variability of FSL-only signal magnitudes. To explore the spatial patterns of where the two analyses differed, a 3 (Method: OGRE, fMRIprep, FSL-only) * 14 (Network) * 2 (Hemisphere: left, right) ANOVA was performed on the standard deviations of the network ROIs. One ROI (in visual cerebellum) was omitted from the ANOVA because it was not associated with either hemisphere, leaving 299 ROIs in the ANOVA. Post-hoc tests were performed using Tukey\u2019s Honestly Significant Difference procedure for effects of interest (i.e. involving the Method factor) at alpha = 0.05. \n\nThe second approach for comparing analyses focused on mean signal magnitude. The same process was followed as above, except: the primary variable was the mean signal magnitude (across the 39 participants). Direct statistical comparisons used paired-sample t-tests. \n\nSeparately from the above, task-specific results were compared across analyses by quantifying results in a normatively defined left hemisphere hand motor cortex ROI, ( ) a sphere of 5 mm radius centered on MNI coordinates X = \u221238, Y = \u221224, Z = 54. This ROI was used to compare the results from the three analyses by measuring each analysis\u2019 Z-score for Draw > Rest at the top level (across participants). Z-score distributions were compared with paired-sample t-tests,   \u03b1   = 0.0167 (0.05 / 3 to provide Bonferroni correction for three pairwise comparisons). \n\n\n#### Whole-brain analyses. \n  \nTo evaluate whole-brain results from each pipeline, a third-level analysis was performed to identify the mean activation (for Draw > Rest) within each pipeline. Subsquently, the three pipelines were compared via repeated-measures FEAT GLMs treating the analyses as multiple samples. Three pairwise comparisons were performed (i.e. one for each pair of preprocessing methods), with significant clusters were detected by Z \u2265 3.1 and a corrected cluster significance threshold of   \u03b1   = 0.0167. \n\n\n#### Brain extraction and distortion correction comparisons. \n  \nTo quantify the difference in brain extraction and registration results between analysis methods, we compared the size of post-registration (i.e. standard space) brain masks from each task fMRI scan, following  . Specifically, for all three preprocessing pipelines, comparisons were performed on the reg_standard/mask.nii.gz files generated for the FEAT GLM. Mask sizes were compared with other results with Pearson correlations,   \u03b1   = (0.05/3 to provide Bonferroni correction for 3 pairwise comparisons: \n\nDifferences between analyses in EPI distortion correction were not evaluated because all three analysis pipelines perform distortion correction via the same process. Specifically, in OGRE, EPI images are unwarped with the HCP implementation of the FSL\u2019s topup algorithm ( ;  ;  ). FSL\u2019s topup is also currently used in fMRIprep when fieldmap images are available ( ), so fieldmap-based EPI unwarping should be identical across all three analysis pipelines. Fieldmap acquistions were available for all participants in this study. \n\n\n\n\n## RESULTS \n  \n### Lower inter-individual variability with OGRE compared to FSL-only and fMRIprep analyses. \n  \nOGRE analysis led to lower inter-individual variability (standard deviation) in most ROIs, with lower SD for OGRE compared to either FSL-only (z = \u22122.86, p = 3.1\u00d710 ) or fMRIprep (z = 1.80, p = 3.2\u00d710 ), as detailed in   and summarized in  . For a full list of results for each of the 300 ROIs, see  . \n\nTo explore the pattern of where the three analyses differed, we performed a 4-way ANOVA: 3 (Method: OGRE, FSL-only, FSL-only) * 14 (network) * 2 (hemisphere). We found significant effects of method (F(2,836) = 5.9, p = 0.003) and network (F(13,836)=11.6, p = 2.3\u00d710 ) but not hemisphere (p = 1.0). We found no significant interaction effects (p > 0.18). Post-hoc tests revealed that the network effect arose from higher variability for the networks Unassigned and Visual than most (7\u201310/14) networks. Critically, post-hoc tests revealed that the Method effect arose from lower interindividual variability for OGRE (0.458 \u00b1 0.370, median 0.372) than fMRIprep (0.592 \u00b1 0.293, median 0.528) or FSL (0.615 \u00b1 0.300, median 0.539). \n\n\n### Minimal differences in BOLD signal magnitude between OGRE and other analyses \n  \nOGRE analysis led to higher signal magnitude (participant mean % BOLD signal change for Task > Rest) more often than lower signal magnitude, compared to FSL-only analysis (t = \u22123.9, p = 1.2\u00d710 ); and fMRIprep led to higher signal magnitudes than FSL-only analysis (t = \u22129.75, p = 1.1\u00d710 ), as detailed in   and summarized in  . For a full list of results for each of the 300 ROIs, see  . \n\nTo explore the pattern of where the three analyses differed, we performed a 4-way ANOVA: 3 (Method: OGRE, FSL-only, FSL-only) * 14 (network) * 2 (hemisphere)) on mean signal magnitudes. We found significant effects of Network (F(13,836) = 3.0, p = 1.7\u00d710 ), but not Hemisphere (p = 1.0) or Method (p = 0.838). We found a significiant interaction effect for Hemisphere * Network (F(13,848) = 3.54, p = 2.1\u00d710 ) but no others (p > 0.5). Post-hoc analyses revealed that the Network effect arose from higher mean activity in the Dorsal Attention network than all other networks, and higher in CinguloOpercular and SomatoMotor-Dorsal than in most (9/14) networks; and that the Hemisphere * Network interaction arose because the Salience network had higher mean activity in the left hemisphere than right hemisphere. However, we found no effects of Method on BOLD signal magnitude. \n\n\n### Increased signal in in task-specific areas when using OGRE, especially vs. FSL-only \n  \nTo assess the effects of OGRE analysis on the whole brain, we conducted whole-brain repeated measures analyses, treating the three analyses (OGRE, fMRIprep, FSL) as separate measures for each participant. Each analysis method led to grossly similar results, but with a scattered network of areas that showed significant differences between methods, as shown in  . \n\nTo provide a quantitative contrast between analyses in an area with known \u201cground truth,\u201d we compared results across methods in left hemisphere normative hand M1, contralateral to the drawing right hand ( ). Z-scores for OGRE analysis were significantly higher than FSL-only (t = \u22123.51, p = 0.001), but non-significantly higher than fMRIprep (t = 1.74, p = 0.90); the difference between FSL and fMRIprep was not significant after multiple comparison correction   \u03b1   = 0.167 (t = \u22122.08, p = 0.45). While all three methods were perfectly capable of detecting task-specific activity in a task-relevant brain area, OGRE analysis was significantly better than FSL-only at detecting this task-specific activity, and produced the highest z-scores overall. \n\n\n### OGRE identified smaller brain volumes, primarily through removal of non-brain voxels \n  \nTo quantify the difference in brain extraction results between analysis methods, we compared the size of post-registration (i.e. standard space) brain masks of task fMRI runs. OGRE masks were substantially smaller than masks produced by other methods, incorporating fewer non-brain voxels, as detailed in  . However, the importance of mask size depends on the method, as shown in  . In FSL-only and fMRIprep analyses, results did not correlate significantly with mask size, suggesting that their large mask sizes did not impede analysis (likely due to the inclusion of distal non-brain areas with no BOLD signal). However OGRE performance was positively correlated with: Z-scores in contralateral M1 were significantly correlated with the number of total voxels and non-brain voxels, suggesting that OGRE produced masks that were too small (i.e. removed too many non-brain voxels for optimal performance under spatial smoothing), and OGRE \u2013 despite producing the highest Z-scores of the three methods \u2013 might achieve still better performance with larger brain estimates. \n\n\n### Differences between analysis methods are broadly consistent across participants \n  \nOur participant group included at least one major unmodeled source of variance: the distinction between typical adults and patients with peripheral nerve injury. This provides an advantage for practical testing, because it highlights OGRE\u2019s robustness in the face of complex real-world data. However, we must rule out the possibility that this sample choice distorted our results. To address this, we first assessed whether participant group (patient vs. control) affected our measure of task-related BOLD signal (% BOLD signal change during Task > Rest). We performed a between-groups t-test to assess group differences in BOLD signal magnitude, and repeated this analysis separately for each ROI*analysis method (i.e. 900 comparisons), without multiple comparison correction. We found group effects in 13/300 ROIs with FSL analysis, 12/300 ROIs with OGRE, and 8/300 ROIs with fMRIprep, rates which do not significantly differ across analysis methods (for the most-different pair of methods, \u03c7  = 1.2, p = 0.267). Therefore, peripheral nerve injury seemed to have no systematic effect on the measures tested here. \n\nTo further address the underlying concern about between-methods effects potentially being unevenly distributed across individuals, we examined the correlation of signal intensities (% BOLD signal change, Task > Rest) between methods, for each ROI. Correlations were high, especially for OGRE vs. fMRIprep, as shown in  , showing a broadly linear relationship across methods, which suggests that the effects here do not depend on subgroups or systematic differences between participants. \n\n\n\n## DISCUSSION \n  \nOGRE preprocessing led to greater detection of task-related activity and reduced inter-individual BOLD variability in volumetric FSL analysis of a motor task, which demonstrates the advantages of combining motion correction and registration via the \u201cone-step resampling\u201d process. OGRE had weaker advantages over fMRIprep analysis than FSL-only advantages, demonstrating separate benefits of Freesurfer brain extraction (shared by fMRIprep and OGRE) and motion correction via one-step resampling (OGRE only). The three methods produced grossly similar results, but for metrics with a clear definition of \u201cbetter,\u201d OGRE results were always significantly or trending better than all other methods. OGRE software will allow any FSL user to take advantage of these preprocessing benefits. \n\n### Increased task-related signal in functional analysis after one-step resampling \n  \nWe directly compared OGRE preprocessing with FSL and fMRIprep preprocessing by analyzing the same data with the same subsequent volumetric GLM analysis (in FSL FEAT). Our ultimate finding was that OGRE led to greater detection of BOLD signal in a brain area where activity is certainly task-relevant (M1 contralateral to movement,  ). This detection of task-relevant activity (i.e. M1 Z-score) was significantly higher for OGRE than FSL-only; detection did not differ significantly between OGRE and fMRIprep, but OGRE had higher mean and median Z-scores than fMRIprep, indicating that OGRE\u2019s signal detection performance was as-good-or-better versus any other method. \n\nOGRE also led to increased BOLD signal in deep structures that likely represent noise (e.g. white matter, ventricles;  ). This may reflect amplification of real artifacts present in the data (e.g. movement-related). While amplification of artifacts is unhelpful, it is easily distinguishable from the expected cortical areas and networks involved in a task (here, precision drawing), and thus the heightened signal in deep structures should not present an obstacle to interpretation of task fMRI results. \n\nBecause we used real data rather than simulated data, it is impossible to determine whether increased signal in taskrelevant areas reflects a more-precise measurement of a strong signal, or a less-precise measurement of a weak signal. However, the latter interpretation \u2013 artifactual inflation of BOLD signal strength \u2013 is incompatible with our finding that OGRE did not produce the highest signal magnitudes of our methods ( ), but did produce the lowest interindividual variability, as discussed in the next section. \n\n\n### Reduced inter-individual variability after one-step resampling \n  \nOGRE preprocessing led to signigicantly lower inter-individual variability in BOLD signal across the brain, compared to either FSL or fMRIprep preprocessing ( ). This is likely due to the two primary differences between OGRE and fMRIprep: OGRE\u2019s one-step resampling procedure, or OGRE\u2019s FNIRT inter-subject registration vs. fMRIprep\u2019s ANTs inter-subject registration. ANTs registration has high precision for spatial normalization ( ), so one-step resampling is likely the primary explanation for OGRE\u2019s advantages. Therefore, the one-step resampling procedure improves analytic control over the effects of individual differences in brain anatomy and head movement on fMRI analysis. \n\nThe decreased inter-individual variability with OGRE compred to fMRIprep supports the value of simultaneous registration and motion correction via one-step resampling. Inter-individual variability is a longstanding challenge in fMRI research ( ;  ), because group averaging creates a tradeoff between statistical power and relevance to individual participants. Numerous methods exist to tackle inter-individual variability in fMRI data, but the best methods require specific data collection tools or lengthy data collection sessions ( ;  ;  ), so analysis-based approaches will remain useful in many situations. \n\n\n### The precision of brain extraction is not a critical driver of analysis outcomes \n  \nOGRE performs its registration and brain extraction by combining the established algorithms of FSL FLIRT and FNIRT ( ) with FreeSurfer (e.g.  ;  ;  ). OGRE and fMRIprep, unlike standard FreeSurfer, allow a direct comparison to FSL\u2019s brain extraction. The OGRE pipeline led to substantially smaller brain volume estimates for task fMRI scans, but these small volumes were counter-productive: participants whose masks included more non-brain voxels had better analysis outcomes (higher Z-scores in contralateral M1), indicating that larger masks were more optimal. This is likely because spatial smoothing places information into proximal non-brain voxels, but OGRE\u2019s HCP registration is designed for minimal preprocessing (i.e. without spatial smoothing) and thus aggressively excludes non-brain voxels \u2013 some of which contain information about a brain-surface region such as M1. Future versions of OGRE will increase brain size, which should improve OGRE\u2019s analysis outcomes. \n\nOtherwise, brain mask size was not correlated with analysis outcome in FSL or fMRIprep, suggesting that \u2013 despite our original motivation to remove BET brain extraction from FSL analysis \u2013 the precision of brain extraction does not necessarily play a critical role in the outcome of task fMRI analysis. Brain extraction precision may play a minor role, or a role in other metrics; but here, the inclusion of non-brain voxels did not impair analysis outcomes, likely because of the lack of task-dependent BOLD signal in distal non-brain voxels. However, even if differences in brain extraction play only a minor role in identifying task effects, Freesurfer contains numerous other advantages compared to FSL-only brain extraction, such as segmentation of gray vs. white matter. \n\n\n### Use case of OGRE: improved preprocessing for researchers who prefer volumetric analysis \n  \nOGRE uses some code and concepts developed by the Human Connectome Project (HCP), including the original idea for one-step resampling; but OGRE should not be mistaken for an implementation of the HCP pipeline, which incorporates many other features including a surface-based approach to fMRI data analysis ( ;  ;  ). Surface-based analysis has many demonstrated benefits ( ), but not all analysis approaches are suitable for all research questions, groups, and protocols. Here we have quantified the advantages of Freesurfer and the one-step resampling procedure (registration and motion correction) during preprocessing, and demonstrated that those advantageous preprocessing steps can be leveraged to improve task fMRI analyses with the popular, accessible FSL toolbox. \n\n\n### Limitations \n  \nHere we compared three preprocessing approaches using a motor task fMRI dataset and two traditional volumetric magnitude-based analysis methods (ROI, whole-brain). Many future directions present themselves, including using multivariate similarity-based fMRI analyses ( ); and evaluating other data sets such as other tasks, task-free MRI, large datasets, and simulated data with known ground truth. Given the reduced inter-individual variability provided by OGRE preprocessing, we expect it to demonstrate benefits across a broad range of analyses and datasets, and we welcome further testing of OGRE\u2019s robustness. \n\nOGRE version 1.0.0 uses code derived from HCP 3.27.0, and as such may not reflect updates or bug fixes in future versions of the HCP code. Future updates to OGRE will link it to the main HCP repository to avoid this problem. \n\n\n\n## CONCLUSION \n  \nTask fMRI analysis can be improved with preprocessing approaches that integrate tools from FSL, HCP, and FreeSurfer. We demonstrated that the \u201cone-step resampling\u201d preprocessing approach (i.e. simultaneous registration and motion correction, originally developed for HCP) can be applied to FSL volumetric analysis to reduce inter-individual variability throughout the brain, and increase signal in task-related regions of the brain. Gross results were largely consistent between preprocessing methods, but the one-step resampling procedure consistently led the best outcomes. Given these advantages of the one-step resampling approach, it may serve as a new methodological standard for preprocessing of fMRI data in FSL FEAT volumetric analysis. We developed the OGRE (One-step General Registration and Extraction) software to provide FSL users with an off-the-shelf general-purpose solution to implement and integrate this preprocessing approach. OGRE is available online at:  . \n\n\n## Supplementary Material \n  \n \n", "metadata": {"pmcid": 10541115, "text_md5": "37f46c6a3fe92e0f0503a326fd599a68", "field_positions": {"authors": [0, 69], "journal": [70, 77], "publication_year": [79, 83], "title": [94, 209], "keywords": [223, 315], "abstract": [328, 1621], "body": [1630, 31212]}, "batch": 1, "pmid": 37781580, "doi": "10.1101/2023.09.19.558290", "pmc_url": "https://www.ncbi.nlm.nih.gov/pmc/articles/PMC10541115", "efetch_url": "https://eutils.ncbi.nlm.nih.gov/entrez/eutils/efetch.fcgi?db=pmc&id=10541115"}, "display_title": "pmcid: <a href=\"https://www.ncbi.nlm.nih.gov/pmc/articles/PMC10541115\">10541115</a>", "list_title": "PMC10541115  Reducing individual differences in task fMRI with OGRE (One-step General Registration and Extraction) preprocessing"}
