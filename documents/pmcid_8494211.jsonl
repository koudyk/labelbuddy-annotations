{"text": "Baltoumas, Fotis A and Zafeiropoulou, Sofia and Karatzas, Evangelos and Paragkamian, Savvas and Thanati, Foteini and Iliopoulos, Ioannis and Eliopoulos, Aristides G and Schneider, Reinhard and Jensen, Lars Juhl and Pafilis, Evangelos and Pavlopoulos, Georgios\u00a0A\nNAR Genom Bioinform, 2021\n\n# Title\n\nOnTheFly2.0: a text-mining web application for automated biomedical entity recognition, document annotation, network and functional enrichment analysis\n\n# Keywords\n\n\n\n# Abstract\n \nExtracting and processing information from documents is of great importance as lots of experimental results and findings are stored in local files. Therefore, extracting and analyzing biomedical terms from such files in an automated way is absolutely necessary. In this article, we present OnTheFly , a web application for extracting biomedical entities from individual files such as plain texts, office documents, PDF files or images. OnTheFly  can generate informative summaries in popup windows containing knowledge related to the identified terms along with links to various databases. It uses the EXTRACT tagging service to perform named entity recognition (NER) for genes/proteins, chemical compounds, organisms, tissues, environments, diseases, phenotypes and gene ontology terms. Multiple files can be analyzed, whereas identified terms such as proteins or genes can be explored through functional enrichment analysis or be associated with diseases and PubMed entries. Finally, protein\u2013protein and protein\u2013chemical networks can be generated with the use of STRING and STITCH services. To demonstrate its capacity for knowledge discovery, we interrogated published meta-analyses of clinical biomarkers of severe COVID-19 and uncovered inflammatory and senescence pathways that impact disease pathogenesis. OnTheFly  currently supports 197 species and is available at   and  . \n \n\n# Body\n \n## INTRODUCTION \n  \nThe extraction and processing of information from literature is of paramount importance in biomedical sciences. More often than not, researchers need to cope with the task of manually sifting through large amounts of text in various forms (e.g. scientific articles in various file formats, data in spreadsheets and images) in order to obtain pertinent biological information about genes, proteins, chemical compounds, organisms and biological processes and functions. The manual approach is summarized as follows: (i) read through the article texts, (ii) detect biomedical entities of interest and (iii) query one or more databases for the relevant information. As the volume of literature and experiment-derived datasets continues to increase, this iterative procedure can become slow and heavy. For this reason, text-mining methods are often employed to aid researchers in automatically extracting and searching meaningful biological terms from texts. \n\nOne particular application of text mining that is widely used in scientific text processing is named entity recognition (NER), i.e. identifying words or phrases of interest (the so-called \u2018named entities\u2019) mentioned in plain text, and normalizing them to appropriate database/ontology identifiers ( ). In biological and biomedical sciences, these entities include gene and protein names, organisms (scientific or common names), chemical compounds and ontology terms such as biological processes, cellular components, molecular functions, diseases, phenotypes and environmental descriptors. Numerous computational tools and web services for NER have been proposed [reviewed in ( )]. Characteristic examples include tools like EXTRACT ( ), PubTator ( ), HunFlair ( ), BioTextQuest  ( ), Saber ( ), OGER++ ( ) and others. Altogether, these tools detect genes/proteins, genetic variants, diseases, chemical compounds, organisms, diseases and cell lines mentioned in documents. However, while being able to successfully identify entities is critical, NER is only one of the components for meaningful parsing and analysis of the scientific literature. The result of running NER on a set of documents will be a long list of genes and other entities, which the user then needs to navigate and make sense of. \n\nNetwork visualization is one popular way to get an overview of a large number of entities. Molecular networks can be obtained from a wide variety of different sources, including manually curated pathway databases, e.g. KEGG ( ) and Reactome ( ), and databases of interaction experiments, e.g. IntAct ( ) and BioGRID ( ). Resources like STRING ( ) and STITCH ( ) combine these with additional associations that are predicted or extracted from the biomedical literature through automatic text mining ( ). All of these resources can be queried manually by the user, or automatically through application programming interfaces (APIs), packages or plugins. Their results can be used to generate, visualize and analyze interaction networks with network viewers such as Cytoscape ( ), Gephi ( ), NORMA ( ) and others [reviewed in ( , )]. \n\nFunctional enrichment analysis is another commonly used approach, which summarizes a long list of genes by comparing their associated functional annotations against a collection of gene set annotation terms, each representing a gene ontology term, molecular pathway, protein domain, disease etc. Statistically enriched gene annotation sets are then identified by comparing their frequency against a reference background list. Widely used tools for enrichment analysis include DAVID ( ), PANTHER ( ), WebGestalt ( ), aGOtool ( ) and g:Profiler ( , ), each adopting different statistical tests and supporting different enrichment options [reviewed in ( , )]. \n\nIn this article, we present OnTheFly , a full, user-friendly pipeline which goes far beyond just applying NER and allows users to start from a collection of documents and, via a set of entities, perform network and enrichment analyses. Through a user-friendly, interactive web interface, OnTheFly  supports a plethora of different file formats for text mining and biomedical entity extraction, including text documents (in both editable and read-only formats), spreadsheets and image files. Through NER, OnTheFly  can recognize and retrieve a large variety of both biological and biomedical terms. Extracted protein and chemical entities can be combined to create datasets for various types of analyses, including functional enrichment, related literature finding, associations with diseases and protein domain reporting from protein family databases. In addition, OnTheFly  allows the generation and visualization of protein\u2013protein and protein\u2013chemical interaction networks. The capabilities of OnTheFly  are shown using a case study in which several inflammatory and senescence pathways that impact COVID-19 pathogenesis have been unraveled after analyzing six clinical articles with mentions to clinical biomarkers of severe COVID-19. \n\n\n## MATERIALS AND METHODS \n  \nThe OnTheFly  pipeline consists of four steps (Figure  ): (i) uploading of input files and conversion from their original format to HTML, (ii) identification of bioentities with EXTRACT, (iii) functional annotation on a set of selected identifiers and (iv) network analysis. A detailed description of these steps is provided in the following subsections. \n  \nFlowchart of the OnTheFly  backend pipeline for file conversion, named entity recognition and data analysis. \n  \n### File conversion pipeline \n  \nIn its current version, OnTheFly  supports annotation for PDF files, Office-formatted documents, various flat text file formats, including XML and images. In the online version, each file must have a maximum size of 10 MBs. Users can upload multiple files simultaneously and process them separately or in combination. \n\nOnTheFly  uses various tools and pipelines in its backend to convert uploaded files to HTML format prior to annotation. PDF files are converted with the use of   pdf2htmlEX  , an open-source package ( ), whereas the   LibreOffice   universal converter (  unoconv  ) is used to convert Office files, including formatted/enriched text files (MS Office .doc/.docx, OpenOffice .odt, Rich Text Format .rtf) and spreadsheets (MS Excel .xls/xlsx, OpenOffice Spreadsheet .odp), tab- and comma-delimited table files (.tsv and .csv, respectively), XML files, as well as flat text (.txt) files. Notably, in the case of spreadsheet documents, the converter is capable of handling each of the sheets. Almost all of the aforementioned file types are converted to HTML with their overall layout, text formatting, formulas and images maintained to the largest extent possible. The only exception are XML files which are rendered as plain texts, without any syntax highlighting for the XML tags. Future versions of OnTheFly will address this issue by implementing more advanced visualization options, including better support for the XML format. \n\nIn addition to the above, OnTheFly  can utilize optical character recognition (OCR) scan on images with no text encoding. Both common (.bmp, .jpg, .png, .tiff) and PostScript-compliant image file formats (.ps and .eps) are supported. Image preprocessing and file format conversion is performed with the open-source package   ImageMagick  . OCR scanning of images is performed using the   tesseract-ocr   package ( ) to produce PDF files with parseable text, which are then processed as described above. Successful OCR scanning heavily depends on the quality of the imported image, including its resolution. As a result, images containing text elements in rotated orientation or embedded in complex graphical shapes, or images with low resolution may result in poor OCR results. \n\nAfter files have been uploaded and converted, the resulting HTML version can be inspected in a viewer that has each document in a separate tab. This allows the user to identify conversion or OCR problems before continuing the analysis. \n\n\n### Document annotation using named entity recognition (NER) \n  \nOnce the files have been uploaded, users can annotate them with the help of EXTRACT tagging service ( ). EXTRACT performs dictionary-based NER using the highly efficient   tagger   software ( ) to detect words and phrases, which correspond to biomedical entities. This is performed through a dictionary-based approach, through which biological and biomedical terms, both canonical and synonyms, are assigned to database and ontology identifiers; thus producing concept-normalized results. In detail, EXTRACT is capable of identifying environment descriptive terms from environment ontology (e.g. desert and forest) ( ), organism mentions from NCBI Taxonomy ( ), tissue terms from BRENDA Tissue Ontology ( ), disease mentions from Disease Ontology ( ), phenotypes from Mammalian Phenotype Ontology ( ), biological processes, cellular components, molecular functions from Gene Ontology ( , ), small chemical molecules from PubChem ( ), non-coding RNAs from RAIN ( ) and protein-coding genes from STRING ( ). In the implementation of OnTheFly , NER can be performed for a list of 197 organisms. \n\nOnce the annotation parameters (entity types and organisms) have been set and a NER process has been completed, OnTheFly  will return the annotated document with all of the recognized terms linked and highlighted using different colors (Figure  ). On mouse-click action on a term, OnTheFly  will generate a popup window with details about the biomedical entity and links to external databases. In case of term disambiguation (e.g. when a term comes from several organisms or corresponds to more than one entity type), OnTheFly  will report all of the possible options. For a more comprehensive summary, all of the identified terms along with their database identifiers and links are collected in an interactive table and can be exported as a CSV file. The table results can be narrowed down after filtering for entity type (e.g. genes/proteins and diseases) at any stage. The annotation process is presented in Figure  . \n  \nPDF annotation using NER for article by Xiahou   et\u00a0al.  , 2017 ( ). (  A  ) The PDF abstract in its simple form. (  B  ) The annotated abstract using   Mus musculus   as an organism. (  C  ) Popup windows with information about the identified term. The term is colored according to its type and original links to external databases are provided. (  D  ) A summary table with some of the identified terms. \n  \n\n### Functional enrichment analysis \n  \nOnTheFly  uses two tools,   g:Profiler   ( , ) and   aGOtool   ( ), to provide rich functional enrichment analysis for a selected set of genes/proteins collected by one or multiple files. The user can customize parameters for the enrichment analysis and choose from a list of 197 organisms. OnTheFly  uses g:Profiler to identify enriched functional terms from Gene Ontology ( , ), pathways from KEGG ( ), Reactome ( ) and WikiPathways ( ), protein complexes from CORUM ( ), expression data from Human Protein Atlas ( ), regulatory motifs from TRANSFAC ( , ) and miRTarBase ( ), and phenotypes from the Human Phenotype Ontology ( ). The analysis results from g:Profiler are complemented by further enrichment analyses from aGOtool to also identify enriched terms from the UniProt keyword classification system, protein families and domains from Pfam ( ) and InterPro ( ), as well as human diseases from the DISEASES database ( ). g:Profiler and aGOtool test for statistically significant enrichment by using Fisher\u2019s exact test to compare the user-defined input dataset (foreground) to a background set from organism-specific genes annotated in the Ensembl database ( ) and UniProt Reference Proteomes ( ), respectively. The resulting   p  -values are corrected for multiple testing using either g:SCS (only in case of g:Profiler), Bonferroni correction or Benjamin\u2013Hochberg false discovery rate (FDR), all of which can be used as thresholds for the results. Enrichment analysis is performed using ENSEMBL IDs as input, while results can be reported as Entrez, UniProt, EMBL, ENSEMBL and RefSeq gene/protein names/identifiers, based on the user\u2019s choice. \n\nFunctional enrichment results are reported in interactive searchable tables displaying details about each functional term. One can expand each row of the table to see which of the identified genes/proteins were found to be associated with the functional term. For example, in the case of a KEGG pathway, one can see how many proteins or genes were found to be related to it and get redirected to the KEGG repository to see the actual schema of the pathway in a static form with all of the detected genes/proteins highlighted. In the case of g:Profiler, an interactive Manhattan plot is offered for a clearer overview. In this plot, functional terms are grouped along the   x  -axis and colored by their data source, whereas the   y  -axis shows the significance (  P  -value) of each term. Hovering over a data point reveals a tooltip with key information about the functional term. Finally, the most significant functional terms are shown as a bar chart, which the user can customize to show the desired number of terms. All of the aforementioned reports can be exported and saved in various file formats (CSV, XLS, PDF). An overview is shown in Figure  . \n  \nOnTheFly \u2019s functional enrichment. (  A  ) Functional enrichment input parameters. (  B  ) Summary table with the functional terms and the corresponding identified entities. Results from KEGG are shown. (  C  ) A functional enrichment overview with the use of a Manhattan plot. (  D  ) Bar plot for the distribution of enriched genes into metabolic pathways obtained from three pathway databases (KEGG, Reactome, WikiPathways), with the results of each database colored differently. The bar length is proportional to the extent of enrichment for each term, as represented by -log (  P  -value). (  E  ) Portion of a generated KEGG pathway with the genes found in documents highlighted in orange. \n  \n\n### Publication enrichment analysis \n  \nOnTheFly  uses the aGOtool to allow users to find scientific articles that mention surprisingly many of the genes/proteins identified in the uploaded input files. While conceptually similar to the functional enrichment analyses just described, publication enrichment analysis serves a very different purpose, namely to help the user identify scientific publications of relevance to the gene/protein list. The publication enrichment analysis in aGOtool is based on a text corpus of all PubMed abstracts and full-text articles from the PubMed Central Open Access subset. These have been run through the same NER   tagger   used in EXTRACT and the results are updated with new documents on a weekly basis. Consequently, all documents have been automatically annotated with the genes mentioned within them, thus turning every document into a gene set. These millions of gene sets are then used by aGOtool in the same manner as all other gene sets. \n\nWe make use of this functionality to provide publication enrichment functionality in OnTheFly  for the list of 197 organisms. The user can select up to 1000 of the genes/proteins identified in the uploaded files for analysis, which will then be submitted to aGOtool to test each document from the precomputed corpus for statistically significant enrichment, again using Fisher's exact test. The resulting   P  -values as well as Bonferroni-corrected   P  -values and Benjamini\u2013Hochberg FDR values can be used for filtering the results. Results are reported in interactive searchable tables displaying details about each literature term (scientific publication). Links are provided for publications to PubMed. In addition, users are able to rank the most significant publications using barchart plots and manually adjust the number of the reported results with the use of a slide bar. All of the aforementioned reports can be exported and saved in various file formats (CSV, XLS, PDF). \n\n\n### Network analysis \n  \nIn addition to the aforementioned enrichment options, OnTheFly  offers the capability to construct and visualize biomolecular interaction networks for a set of 197 organisms. This task is performed using the APIs of the STRING ( ) and STITCH ( ) databases for protein\u2013protein and protein\u2013chemical interactions, respectively. The users may submit their dataset obtained from the uploaded documents to retrieve interactions and visualize the results as networks with the interacting entities presented as nodes and their interactions as edges. For computational efficiency reasons, in its current version, OnTheFly  allows a maximum of 500 proteins per request for STRING and 100 proteins or small molecules per request for STITCH. \n\nSTRING and STITCH classify interactions between two entities (proteins or small molecules) as either   physical   (i.e. part of the same biomolecular complex) or   functional   (i.e. involved in the same pathway/process). To this end, OnTheFly  requires users to select whether to include the   Full   set of interactions (both physical and functional) or the   Physical subnetwork   exclusively. Users can also specify the cutoff on the   Interaction Score  . Finally, users can choose whether each edge should show the type(s) of evidence (e.g. experiments or text mining) supporting it (  Evidence   mode) or if the thickness of the edge should instead show the interaction score (  Confidence   mode). \n\nIn addition to the above, in protein\u2013chemical networks network edges can be formatted based on   Molecular Action   or   Binding Affinity  . By choosing   Molecular Action  , the edges in the network will represent the type (activation, inhibition, catalysis etc.) as well as the effect (positive, negative or unspecified) of each protein\u2013chemical interaction. By choosing   Binding Affinity  , the edge thickness will indicate the binding affinity between the proteins and bound chemicals. The resulting network is shown in a separate Network Viewer panel, preserving the characteristic STRING network layout and style. An example of such networks is shown in  . In addition, options are given to view the generated network in STRING (protein\u2013protein) or STITCH (protein\u2013chemical) for further analysis. Finally, one can export a network as an image or as a tab-delimited file compatible with external network visualization applications. \n\n\n### Implementation \n  \nOnTheFly  is a web application implemented in R, using the R/Shiny package as well as HTML, CSS and JavaScript. The Shiny and ShinyJS packages are used as mediators to establish the connection between the R and JavaScript functions. The API of the EXTRACT web service which utilizes the   tagger   text mining utility is used to perform NER. Functional enrichment analysis is performed using the g:Profiler2 ( ) package (R implementation of g:Profiler) and aGOtool. Biological networks are constructed and visualized using the STRING API, as implemented in the STRING and STITCH databases. OnTheFly  is available as a web tool and as a standalone package through a GitHub repository. The standalone version is fully functional in native Linux and other Unix-based operating systems. It can also run on Windows, by utilizing a Windows Subsystem for Linux (WSL) or other similar compatibility layers (e.g., Cygwin). The web tool is fully functional in all major web browsers (Google Chrome, Mozilla Firefox, Microsoft Edge, Tor, Apple Safari, Opera) (Table  ). \n  \nOnTheFly  versus OnTheFly \n    \n\n\n## RESULTS \n  \n### Case study \n  \nTo demonstrate the capacity of OnTheFly  for rapid extraction of biological information and knowledge discovery, we analyzed six published meta-analysis reports on clinical biomarkers of severe COVID-19 ( ) ( ). Texts in PDF format were annotated by NER, results filtered to manually remove false positives and jointly processed for functional enrichment analysis. Reassuringly, we found \u2018Respiratory failure\u2019, \u2018Pneumonia\u2019 and \u2018COVID-19\u2019 to be among the most significantly enriched diseases ( ). The GO enrichment for biological processes ( ) identified several GO terms related to inflammation, cell activation and response to stress, in line with COVID-19 being associated with exaggerated lung inflammation and systemic immune dysfunction. Similarly, the annotated text terms were found to be enriched for molecular functions that are associated with cytokine activity and cytokine receptor signaling ( ). These results were supported by the UniProt keyword analysis, which revealed \u2018Cytokine\u2019, \u2018Inflammatory response\u2019, \u2018Host-virus interaction\u2019 and \u2018Host cell receptor for virus entry\u2019 to all be enriched ( ). Analysis of putative protein-protein interactions (physical and functional associations) through the STRING option of OnTheFly  uncovered a cluster of interacting cytokines and other immune components that is pertinent to the \u2018cytokine storm\u2019 of severe COVID-19 (Figure  ). Cytokines are also a recurring theme in the publication enrichment results, which as one would hope further included several COVID-19 studies ( ). \n  \nAnalysis of clinical biomarkers of severe COVID-19 using OnTheFly . (  A  ) List of enriched pathways from the KEGG, Reactome and WikiPathways databases. (  B  ) Analysis of putative protein-protein interactions through the STRING option of OnTheFly . A cluster of interacting components of inflammatory/immune pathways, each represented by a different color, is shown. \n  \nCellular/extracellular components predicted to be associated with biomarkers of severe COVID-19 included extracellular space (GO:0005615, GO:0005576), plasma membrane (GO:0009897, GO:0009986, GO:0098552) and, interestingly, membrane microdomains (also called \u2018membrane rafts\u2019; GO:0098857, GO:0045121) ( ). The latter emerge as important cellular components implicated in (i) the initial binding of SARS-CoV-2 to ACE2 receptor, (ii) virus internalization and (iii) cell-to-cell transmission [reviewed in ( )]. Pertinent to knowledge discovery, this biological information was extracted in the absence of specific reference to membrane microdomains in any of the six meta-analysis reports that were interrogated. \n\nSeveral relevant KEGG pathways were also extracted ( ), including \u2018coronavirus disease - COVID-19\u2019 (KEGG: 05171;  ), \u2018viral protein interaction with cytokine and cytokine receptor\u2019 (KEGG: 04061) and \u2018cytokine-cytokine receptor interaction\u2019 (KEGG: 04060). Interestingly, \u2018Yersinia infection\u2019 (KEGG: 05135) was also identified as a relevant KEGG pathway with high probability (  P  -value<10 ).   Yersinia pestis   is the causative pathogen for pneumonic plague, one of the world\u2019s deadliest infectious diseases.   Yersinia pestis   infects pneumocytes and alveolar macrophages, triggering inflammasome-mediated IL-1\u03b2/IL-18 cytokine release ( ) that is followed by neutrophil influx, exaggerated inflammation and lung tissue damage ( ). These immune and lung tissue reactions to   Yersinia pestis   are reminiscent of those to severe SARS-CoV-2 infection ( ) and warrant further insights into the immunological mechanisms of response to these unrelated pathogens. Of additional interest is the predicted involvement of the \u2018IL-17 signaling pathway\u2019 (KEGG: 04657) in severe COVID-19 ( ) which is supported by a recent study reporting T cell skewing towards Th17, a specialized CD4  effector T cell lineage characterized by secretion of IL-17 and IL-17F cytokines in patients with COVID-19 pneumonia ( ). \n\nWe also explored the REACTOME option of OnTheFly  to map and analyze biological pathways that are over-represented in the validation example. As shown in  , several cytokine pathways were predicted to be significantly associated with biomarkers of severe COVID-19. We note that predicted REACTOME pathways included \u2018cellular senescence\u2019 despite the absence of specific references to this biological term in any of the six annotated meta-analysis reports under study. In line with this prediction, COVID-19 pneumonia has recently been associated with immunosenescence ( ) and accelerated aging of pneumocytes ( ). Overall, the aforementioned analyses underscore the practical utility of OnTheFly  to rapidly extract biological information from texts and hence assisting knowledge discovery (Figure  ). \n\n\n\n## DISCUSSION \n  \nOnTheFly  has been redeveloped to use current technologies and overcome many of the problems of its predecessor ( ). The GUI has been completely rewritten to no longer rely on a Java applet and instead using R, Shiny, CSS, HTML and JavaScript technologies. The backend document format conversion has also been considerably improved, replacing commercial Windows-based converters with open-source, Unix-based ones, which furthermore do a much better job preserving the original document layout. Moreover, compared to its predecessor, OnTheFly  comes with a broader spectrum of term types it can identify and supports OCR technology for processing images. Uploaded files are only stored temporarily in the OnTheFly  server just for parsing and no file backups, copies or personal data are kept. A more detailed comparison between OnTheFly  and OnTheFly  is presented in Table  . \n\n\n## CONCLUSIONS \n  \nOnTheFly  is a powerful tool for identifying terms in locally stored documents varying from texts and PDFs to Office and image files. Users can identify terms such as proteins, genes, chemical compounds, organisms, tissues, environments, diseases, phenotypes and gene ontologies and perform a functional enrichment and network analysis upon selecting a set of biomedical entities. Furthermore, popup windows with informative summaries about a term and its links to external repositories are also generated. OnTheFly  can aid researchers in annotating locally stored documents and further exploring and analyzing their identified biomedical entities in a fully automated way. We believe that due to its offered capabilities and ease of use, OnTheFly  will reach a broad spectrum of users varying from experimentalists to bioinformaticians. \n\n\n## DATA AVAILABILITY \n  \nOnTheFly  is available at:   and  . \n\nThe source code and instructions about the necessary dependencies can be found at  . \n\n\n## Supplementary Material \n  \n \n", "metadata": {"pmcid": 8494211, "text_md5": "afce2553c0ab47f73692e836afc08df7", "field_positions": {"authors": [0, 261], "journal": [262, 281], "publication_year": [283, 287], "title": [298, 449], "keywords": [463, 463], "abstract": [476, 1863], "body": [1872, 28150]}, "batch": 1, "pmid": 34632381, "doi": "10.1093/nargab/lqab090", "pmc_url": "https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8494211", "efetch_url": "https://eutils.ncbi.nlm.nih.gov/entrez/eutils/efetch.fcgi?db=pmc&id=8494211"}, "display_title": "pmcid: <a href=\"https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8494211\">8494211</a>", "list_title": "PMC8494211  OnTheFly2.0: a text-mining web application for automated biomedical entity recognition, document annotation, network and functional enrichment analysis"}
